"use strict";Blockly.Blocks.move_goToBarCounter={init:function(){this.setColour(160);this.appendValueInput("VALUE").setCheck("Number").appendField("goToBarCounter");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(BlocklyApps.getMsg("SnackMan_goToBarCounterTooltip"))}};Blockly.JavaScript.move_goToBarCounter=function(b){var a=Blockly.JavaScript.valueToCode(b,"VALUE",Blockly.JavaScript.ORDER_NONE)||"0";return"goToBarCounter("+a+");\n"};Blockly.Blocks.do_deliver={init:function(){this.setColour(160);this.appendValueInput("VALUE").appendField("deliver");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(BlocklyApps.getMsg("SnackMan_deliverTooltip"))}};Blockly.JavaScript.do_deliver=function(b){var a=Blockly.JavaScript.valueToCode(b,"VALUE",Blockly.JavaScript.ORDER_NONE)||"0";return"deliver("+a+");\n updateVariables(); \n "};Blockly.Blocks.ask_isThereACustomer={init:function(){this.setColour(160);this.setOutput(true,"Boolean");this.appendDummyInput().appendField("isThereACustomer");this.setTooltip(BlocklyApps.getMsg("SnackMan_isThereACustomerTooltip"))}};Blockly.JavaScript.ask_isThereACustomer=function(a){return["isThereACustomer( )",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.move_goToDisplay={init:function(){this.setColour(160);this.appendDummyInput().appendField("goToDisplay");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(BlocklyApps.getMsg("SnackMan_goToDisplayTooltip"))}};Blockly.JavaScript.move_goToDisplay=function(a){return"goToDisplay();\n"};Blockly.Blocks.ask_askForFood={init:function(){this.setColour(160);this.setOutput(true);this.appendDummyInput().appendField("askForFood");this.setTooltip(BlocklyApps.getMsg("SnackMan_askForFoodTooltip"))}};Blockly.JavaScript.ask_askForFood=function(a){return["askForFood()",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.ask_askHasHunger={init:function(){this.setColour(160);this.setOutput(true);this.appendDummyInput().appendField("askHasHunger");this.setTooltip(BlocklyApps.getMsg("SnackMan_askHasHungerTooltip"))}};Blockly.JavaScript.ask_askHasHunger=function(a){return["hasHunger( )",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.prepare_catchFood={init:function(){this.setColour(160);this.setOutput(true,"Foods");this.appendValueInput("VALUE").setCheck("FoodOrder").appendField("catchFood");this.setTooltip(BlocklyApps.getMsg("SnackMan_catchFoodTooltip"))}};Blockly.JavaScript.prepare_catchFood=function(b){var a=Blockly.JavaScript.valueToCode(b,"VALUE",Blockly.JavaScript.ORDER_NONE)||"null";return["catchFood( "+a+" )",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.move_goToCooler={init:function(){this.setColour(160);this.appendDummyInput().appendField("goToCooler");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(BlocklyApps.getMsg("SnackMan_goToCoolerTooltip"))}};Blockly.JavaScript.move_goToCooler=function(a){return"goToCooler();\n"};Blockly.Blocks.move_goToBoxOfFruits={init:function(){this.setColour(160);this.appendDummyInput().appendField("goToBoxOfFruits");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(BlocklyApps.getMsg("SnackMan_goToBoxOfFruitsTooltip"))}};Blockly.JavaScript.move_goToBoxOfFruits=function(a){return"goToBoxOfFruits();\n"};Blockly.Blocks.prepare_catchFruits={init:function(){this.setColour(160);this.setOutput(true);this.appendValueInput("VALUE").appendField("catchFruits");this.setTooltip(BlocklyApps.getMsg("SnackMan_catchFruitsTooltip"))}};Blockly.JavaScript.prepare_catchFruits=function(b){var a=Blockly.JavaScript.valueToCode(b,"VALUE",Blockly.JavaScript.ORDER_NONE)||"null";return["catchFruits("+a+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.move_goToJuiceMachine={init:function(){this.setColour(160);this.appendDummyInput().appendField("goToJuiceMachine");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(BlocklyApps.getMsg("SnackMan_goToJuiceMachineTooltip"))}};Blockly.JavaScript.move_goToJuiceMachine=function(a){return"goToJuiceMachine();\n"};Blockly.Blocks.prepare_prepareAndCatchJuice={init:function(){this.setColour(160);this.setOutput(true);this.appendValueInput("VALUE").appendField("prepareAndCatchJuice");this.setTooltip(BlocklyApps.getMsg("SnackMan_prepareAndCatchJuiceTooltip"))}};Blockly.JavaScript.prepare_prepareAndCatchJuice=function(b){var a=Blockly.JavaScript.valueToCode(b,"VALUE",Blockly.JavaScript.ORDER_NONE)||"null";return["prepareAndCatchJuice("+a+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.ask_askForDrink={init:function(){this.setColour(160);this.setOutput(true,"DrinkOrder");this.appendDummyInput().appendField("askForDrink");this.setTooltip(BlocklyApps.getMsg("SnackMan_askForDrinkTooltip"))}};Blockly.JavaScript.ask_askForDrink=function(a){return["askForDrink( )",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.ask_askHasThirsty={init:function(){this.setColour(160);this.setOutput(true);this.appendDummyInput().appendField("askHasThirsty");this.setTooltip(BlocklyApps.getMsg("SnackMan_askHasThirstyTooltip"))}};Blockly.JavaScript.ask_askHasThirsty=function(a){return["hasThirsty( )",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.prepare_catchDrink={init:function(){this.setColour(160);this.setOutput(true,"Drinks");this.appendValueInput("VALUE").setCheck("DrinkOrder").appendField("catchDrink");this.setTooltip(BlocklyApps.getMsg("SnackMan_catchDrinkTooltip"))}};Blockly.JavaScript.prepare_catchDrink=function(b){var a=Blockly.JavaScript.valueToCode(b,"VALUE",Blockly.JavaScript.ORDER_NONE)||"null";return["catchDrink( "+a+" )",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.const_juiceOfOrange={init:function(){this.setColour(50);this.setOutput(true);this.appendDummyInput().appendField("juiceOfOrange");this.setTooltip(BlocklyApps.getMsg("SnackMan_constjuiceOfOrangeTooltip"))}};Blockly.JavaScript.const_juiceOfOrange=function(a){return['"\\"$$$juiceoforange\\""',Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.const_softDrink={init:function(){this.setColour(50);this.setOutput(true);this.appendDummyInput().appendField("softDrink");this.setTooltip(BlocklyApps.getMsg("SnackMan_constSoftDrinkTooltip"))}};Blockly.JavaScript.const_softDrink=function(a){return['"\\"$$$coke\\""',Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.Blocks.variables_set.init=function(){this.setHelpUrl(Blockly.Msg.VARIABLES_SET_HELPURL);this.setColour(330);this.interpolateMsg(BlocklyApps.getMsg("Blockly_variableSet"),["VALUE",null,Blockly.ALIGN_RIGHT],["VAR",new Blockly.FieldVariable(Blockly.Msg.VARIABLES_SET_ITEM)],Blockly.ALIGN_RIGHT);this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(Blockly.Msg.VARIABLES_SET_TOOLTIP);this.contextMenuMsg_=Blockly.Msg.VARIABLES_SET_CREATE_GET;this.contextMenuType_="variables_get"};"use strict";var Slider=function(h,f,b,e,i){this.KNOB_Y_=f-12;this.KNOB_MIN_X_=h+8;this.KNOB_MAX_X_=h+b-8;this.TARGET_OVERHANG_=20;this.value_=0.5;this.changeFunc_=i;this.animationTasks_=[];var d=document.createElementNS(Slider.SVG_NS_,"line");d.setAttribute("class","sliderTrack");d.setAttribute("x1",h);d.setAttribute("y1",f);d.setAttribute("x2",h+b);d.setAttribute("y2",f);e.appendChild(d);this.track_=d;var g=document.createElementNS(Slider.SVG_NS_,"rect");g.setAttribute("style","opacity: 0");g.setAttribute("x",h-this.TARGET_OVERHANG_);g.setAttribute("y",f-this.TARGET_OVERHANG_);g.setAttribute("width",b+2*this.TARGET_OVERHANG_);g.setAttribute("height",2*this.TARGET_OVERHANG_);g.setAttribute("rx",this.TARGET_OVERHANG_);g.setAttribute("ry",this.TARGET_OVERHANG_);e.appendChild(g);this.trackTarget_=g;var c=document.createElementNS(Slider.SVG_NS_,"path");c.setAttribute("class","sliderKnob");c.setAttribute("d","m 0,0 l -8,8 v 12 h 16 v -12 z");e.appendChild(c);this.knob_=c;var a=document.createElementNS(Slider.SVG_NS_,"circle");a.setAttribute("style","opacity: 0");a.setAttribute("r",this.TARGET_OVERHANG_);a.setAttribute("cy",f);e.appendChild(a);this.knobTarget_=a;this.setValue(0.5);while(e&&e.nodeName.toLowerCase()!="svg"){e=e.parentNode}this.SVG_=e;Slider.bindEvent_(this.knobTarget_,"mousedown",this,this.knobMouseDown_);Slider.bindEvent_(this.knobTarget_,"touchstart",this,this.knobMouseDown_);Slider.bindEvent_(this.trackTarget_,"mousedown",this,this.rectMouseDown_);Slider.bindEvent_(this.SVG_,"mouseup",null,Slider.knobMouseUp_);Slider.bindEvent_(this.SVG_,"touchend",null,Slider.knobMouseUp_);Slider.bindEvent_(this.SVG_,"mousemove",null,Slider.knobMouseMove_);Slider.bindEvent_(this.SVG_,"touchmove",null,Slider.knobMouseMove_);Slider.bindEvent_(document,"mouseover",null,Slider.mouseOver_)};Slider.SVG_NS_="http://www.w3.org/2000/svg";Slider.activeSlider_=null;Slider.startMouseX_=0;Slider.startKnobX_=0;Slider.prototype.knobMouseDown_=function(c){if(c.type=="touchstart"){if(c.changedTouches.length!=1){return}Slider.touchToMouse_(c)}Slider.activeSlider_=this;Slider.startMouseX_=this.mouseToSvg_(c).x;Slider.startKnobX_=0;var a=this.knob_.getAttribute("transform");if(a){var b=a.match(/translate\(\s*([-\d.]+)/);if(b){Slider.startKnobX_=Number(b[1])}}c.preventDefault()};Slider.knobMouseUp_=function(a){Slider.activeSlider_=null};Slider.mouseOver_=function(b){if(!Slider.activeSlider_){return}var a=b.target;do{if(a==Slider.activeSlider_.SVG_){return}}while(a=a.parentNode);Slider.knobMouseUp_(b)};Slider.knobMouseMove_=function(c){var b=Slider.activeSlider_;if(!b){return}if(c.type=="touchmove"){if(c.changedTouches.length!=1){return}Slider.touchToMouse_(c)}var a=b.mouseToSvg_(c).x-Slider.startMouseX_+Slider.startKnobX_;b.setValue((a-b.KNOB_MIN_X_)/(b.KNOB_MAX_X_-b.KNOB_MIN_X_))};Slider.prototype.rectMouseDown_=function(b){if(b.type=="touchstart"){if(b.changedTouches.length!=1){return}Slider.touchToMouse_(b)}var a=this.mouseToSvg_(b).x;this.animateValue((a-this.KNOB_MIN_X_)/(this.KNOB_MAX_X_-this.KNOB_MIN_X_))};Slider.prototype.getValue=function(){return this.value_};Slider.prototype.animateValue=function(f){while(this.animationTasks_.length){clearTimeout(this.animationTasks_.pop())}var g=200;var b=10;var c=this.getValue();var e=this;var a=function(h){return function(){var i=h*(f-c)/(b-1)+c;e.setValue(i)}};for(var d=0;d<b;d++){this.animationTasks_.push(setTimeout(a(d),d*g/b))}};Slider.prototype.setValue=function(b){this.value_=Math.min(Math.max(b,0),1);var a=this.KNOB_MIN_X_+(this.KNOB_MAX_X_-this.KNOB_MIN_X_)*this.value_;this.knob_.setAttribute("transform","translate("+a+","+this.KNOB_Y_+")");this.knobTarget_.setAttribute("cx",a);this.changeFunc_&&this.changeFunc_(this.value_)};Slider.prototype.mouseToSvg_=function(c){var b=this.SVG_.createSVGPoint();b.x=c.clientX;b.y=c.clientY;var a=this.SVG_.getScreenCTM().inverse();return b.matrixTransform(a)};Slider.bindEvent_=function(e,c,b,d){var a=function(f){d.apply(b,arguments)};e.addEventListener(c,a,false)};Slider.touchToMouse_=function(b){var a=b.changedTouches[0];b.clientX=a.clientX;b.clientY=a.clientY};String.prototype.format=function(){var c=this;for(var a=0;a<arguments.length;a++){var b=new RegExp("\\{"+a+"\\}","gi");c=c.replace(b,arguments[a])}return c};var window_prompt=window.prompt;window.prompt=function(d,b){Blockly.fireUiEventNow(window,"showWindowPrompt");var h;do{try{h=window_prompt(d,b);if(h!=null){h=h.trim()}var g=h==null||VariableNames.validate(h);if(g==false){alert(BlocklyApps.getMsg("Error_variableName"))}}catch(c){var f=document.getElementById("dialogError");var a=document.getElementById("dialogErrorText");a.textContent=BlocklyApps.getMsg("Error_showPrompt");var e={width:"400px"};e[Blockly.RTL?"right":"left"]="215px";MyBlocklyApps.showDialog(f,null,false,true,true,"",e,null);return null}}while(!g);return h};var inherits=function(c,a){var b=Object.create(c.prototype);a.prototype=b;a.prototype.constructor=a};function innerXML(d){var e="";for(var c=0;c<d.childNodes.length;c++){var b=d.childNodes.item(c);var a=b.xml||(new XMLSerializer()).serializeToString(b);e+=a}return e}function MyDomToWorkspace(c,e){if(Blockly.RTL){var f=c.getMetrics().viewWidth}for(var a=0;a<e.childNodes.length;a++){var g=e.childNodes[a];if(g.nodeName.toLowerCase()=="block"){var h=Blockly.Xml.domToBlock(c,g);var d=parseInt(g.getAttribute("x"),10);var b=parseInt(g.getAttribute("y"),10);if(!isNaN(d)&&!isNaN(b)){h.moveBy(Blockly.RTL?f-d:d,b)}}}};var PreloadImgs={};PreloadImgs.imgs={};PreloadImgs.keys=[];PreloadImgs.put=function(a,b){PreloadImgs.keys.push(a);PreloadImgs.imgs[a]={src:b,img:null}};PreloadImgs.get=function(a){return PreloadImgs.imgs[a].img};PreloadImgs.loadImgs=function(){for(var b=0;b<PreloadImgs.keys.length;b++){var a=PreloadImgs.imgs[PreloadImgs.keys[b]];a.img=new Image();a.img.src=a.src}};"use strict";var Game={};Game.runningStatus=0;Game.howManyRuns=0;var hero;Game.mission=null;Game.pidList=[];Game.money=0;Game.currentlyMoney=Game.money;Game.lastErrorData;Game.jsInterpreter;Game.variableBox=null;Game.DOWN=1;Game.RIGHT=2;Game.varWindow=Game.RIGHT;Game.counterInstruction=null;Game.init=function(){Game.currTime=0;PreloadImgs.put("fundo","images/fundo.png");PreloadImgs.put("doors","images/doors.png");PreloadImgs.loadImgs();UserControl.verifyLogged(function(a){if(a[0]){Game.renderQuestionnaire(a[1],a[2],a[3],a[4],a[5])}else{window.removeEventListener("unload",Game.unload);document.getElementById("mainBody").style.display="none";document.getElementById("initialBackground").style.display="inline";var b=document.getElementById("loginuser");document.getElementById("errorLogin").style.left=b.offsetLeft+"px"}})};window.addEventListener("load",Game.init);Game.login=function(){var a=document.getElementById("loginuser").value;var b=document.getElementById("loginpassw").value;UserControl.login(a,b,function(d){var c=document.getElementById("errorLogin");if(d[0]==null){document.getElementById("loginuser").value="";document.getElementById("loginpassw").value="";c.innerHTML="";Game.renderQuestionnaire(d[1],d[2])}else{c.innerHTML=BlocklyApps.getMsg(d[0])}})};Game.renderQuestionnaire=function(b,e,a,d,f){Game.loginData={userLogged:b,missionHist:e,clazzId:a,levelId:d,missionIdx:f};try{UserControl.retrieveQuestionnaire(function(h){if(h!=null){var g=Questionnaire.createForm(h);$("#contentQuestionnaire").html("");$("#contentQuestionnaire").append(g);MyBlocklyApps.showDialog(document.getElementById("dialogQuestionnaire"),null,false,true,true,$("#questionnaire").get(0).firstChild.data,null,null)}else{Game.continueLoginProcess()}})}catch(c){Game.init()}};Game.finishQuestionnaire=function(){var a=Questionnaire.consistQuestionnaire();if(a){Questionnaire.handlingQuestionnaire();BlocklyApps.hideDialog(false);Game.continueLoginProcess()}};Game.continueLoginProcess=function(){if(Game.loginData.userLogged.lastTime==null){var b=document.getElementById("userCompleteName");b.innerHTML=Game.loginData.userLogged.name;var a=BlocklyApps.getMsg("NoBugs_intro2");a=a.format((Game.loginData.userLogged.sex==="M"?BlocklyApps.getMsg("King"):BlocklyApps.getMsg("Queen")));var c=document.getElementById("NoBugsIntro2");c.innerHTML=a;MyBlocklyApps.showDialog(document.getElementById("dialogIntro"),null,false,true,true,"Intro",{width:"540px"},null)}else{Game.logged(Game.loginData.missionHist)}};Game.finishIntro=function(){BlocklyApps.hideDialog(false);Game.logged(Game.loginData.missionHist)};Game.logged=function(b){UserControl.updateUserLastTime();if(Game.variableBox!=null){Game.variableBox.style.display="none"}if(Game.loginData.clazzId==undefined||Game.loginData.clazzId==0){document.getElementById("mainBody").style.display="none";document.getElementById("initialBackground").style.display="inline";var a=Game.missionsRetrieved(b);var c=$("<div/>").append($("#"+a)).append(nobugspage.logoffDlgButton(null,null,null));MyBlocklyApps.showDialog(c[0],null,false,true,true,BlocklyApps.getMsg("_missions"),null,function(){$("#"+a).remove()})}else{Game.missionSelected(Game.loginData.clazzId,Game.loginData.levelId,Game.loginData.missionIdx)}};Game.missionsRetrieved=function(d){var h=[];var y=[];for(var r=0;r<d.length;r++){var e=null;var m=h.indexOf(d[r][0]);if(m==-1){h.push(d[r][0]);e={clazz:d[r][0],clazzId:d[r][4],levels:[]};y.push(e)}else{e=y[m]}var p={name:d[r][1],id:d[r][5],howManyMissions:d[r][2],howManyAchieved:d[r][3]};e.levels.push(p)}var b=y.length>1;if(b){if(document.getElementById("aa")!=null){$("#aa").remove()}var x=$('<div id="aa"/>').addClass("easyui-accordion").addClass("accordion").appendTo("body");x.accordion({animate:false})}var u=0;for(var r=0;r<y.length;r++){var f=true;var c="body";if(b){$("#aa").accordion("add",{title:y[r].clazz});c=$("#aa").accordion("getPanel",r)}var o="tt"+r;var v=$('<div id = "'+o+'"/>').addClass("easyui-tabs").addClass("tabs-container").appendTo(c);$("#"+o).tabs();for(var q=0;q<y[r].levels.length;q++){var n="selectMissionPanel"+r+q;var k=$('<div id = "'+n+'"/>').addClass("selectMissionPanel");var t=parseInt(y[r].levels[q].howManyMissions);var a=parseInt((f?y[r].levels[q].howManyAchieved:"-1"));$("#"+o).tabs("add",{title:y[r].levels[q].name,content:k,selected:(a<t&&f)});var g=Game.createGridView("#"+n,t,a,y[r].clazzId,y[r].levels[q].id);f=a==t;if(g>u){u=g}}}for(var r=0;r<y.length;r++){$("#tt"+r).tabs({width:u+50,border:false})}$("#aa").accordion({animate:false,border:false,width:u+50});return(b?"aa":"tt0")};Game.createGridView=function(k,j,c,f,m){var b=c+1;for(var g=1;g<=j;g++){var h=generateImages(g,2);var a=$("<div />").attr("idclazz",f).attr("idmission",g).attr("idlevel",m).addClass("gridViewChild").addClass("missionSquare").html($.each(h,function(l){h[l]="<img src='images/"+this+"'/>"}));if(g<b){a.addClass("missionEnabled")}else{if(g==b){a.addClass("missionTarget")}else{a.addClass("missionDisabled")}}$(k).append(a)}var d=Math.ceil(Math.sqrt(j));var e=function(l,o,n){return{x:(70*(l%d))+n,y:(70*Math.floor(l/d))+n}};$(k).gridview({draggable:false,scrollToZoom:false,animationSpeed:0,width:(d*70)+10,height:(d*70)+10,onPosition:e});$(k).gridview("zoom",{level:d});$(".missionSquare").unbind("click").click(function(i){if(this.className.indexOf("missionTarget")>=0){var l=this.getAttribute("idclazz");var o=this.getAttribute("idmission");var n=this.getAttribute("idlevel");BlocklyApps.hideDialog(true);Game.missionSelected(l,n,o)}});return $(k).width()};Game.missionSelected=function(a,c,d){document.getElementById("initialBackground").style.display="none";document.getElementById("mainBody").style.display="inline";if(Game.counterInstruction!=null){mainBody.removeChild(Game.counterInstruction);Game.counterInstruction=null}Game.removeChangeListeners();BlocklyApps.init();UserControl.retrieveMoney(function(e){Game.money=e});NoBugsJavaScript.redefine();Game.rtl=BlocklyApps.isRtl();Game.optResize={blocklyDivW:600,blocklyDivH:"90%",varBoxT:true,varBoxH:"90%"};window.addEventListener("scroll",function(){Hints.hideHintWithTimer();Game.doResizeWindow()});window.addEventListener("resize",Game.resizeWindow);Blockly.Generator.prototype.STATEMENT_PREFIX="highlightBlock(%1);\n";Blockly.JavaScript.INFINITE_LOOP_TRAP="highlightBlock(%1);\n";Blockly.JavaScript.addReservedWords("Game, code");window.addEventListener("unload",Game.unload);Game.slider={};Game.slider.svg=document.getElementById("slider");Game.slider.svg.style.visibility="hidden";if(Game.speedSlider==undefined){Game.speedSlider=new Slider(10,35,130,Game.slider.svg)}BlocklyApps.bindClick("runButton",Game.runButtonClick);BlocklyApps.bindClick("resetButton",Game.resetButtonClick);BlocklyApps.bindClick("debugButton",Game.debugButtonClick);BlocklyApps.bindClick("goalButton",Game.goalButtonClick);BlocklyApps.bindClick("logoffButton",Game.logoffButtonClick);Game.variableBox=document.getElementById("variableBox");Game.blockly=document.getElementById("blockly");Game.ctxDisplay=document.getElementById("display").getContext("2d");Game.imgBackground=PreloadImgs.get("fundo");Game.imgDoor=PreloadImgs.get("doors");Game.lastErrorData=new Object();Game.lastErrorData.iderror=0;Game.lastErrorData.message="";Game.lastErrorData.block=null;try{UserControl.loadMission(a,c,d,Game.missionLoaded)}catch(b){Game.init()}};Game.unload=function(a){Game.saveMission();return null};Game.saveMission=function(){var b=null;if(Blockly.mainWorkspace!=null){b=Blockly.Xml.domToText(Blockly.Xml.workspaceToDom(Blockly.mainWorkspace))}var a=0;if(Game.currTime!=0){a=Math.floor(((new Date().getTime())-Game.currTime)/1000)}UserControl.saveMission(0,a,Game.howManyRuns,false,b,{callback:function(){},async:false});Game.currTime=new Date().getTime()};Game.missionLoaded=function(g){Game.howManyRuns=parseInt(g[4]);var f=g[1];var j=transformStrToXml(f);var k=BlocklyApps.getMsg("_mission");Game.missionTitle=k.charAt(0).toUpperCase()+k.substring(1)+" "+g[0];var c=j.childNodes[0].getElementsByTagName("commands")[0];Game.slider.timesBefore=0;var a=j.childNodes[0].getElementsByTagName("slider");if(a.length>0){Game.slider.timesBefore=parseInt(a[0].getAttribute("timesBefore"))}if(Game.howManyRuns>=Game.slider.timesBefore){Game.slider.svg.style.visibility="visible"}var h=nobugspage.toolbox(null,null,{enabled:Explanation.selectCommands(c)});document.getElementById("blockly").innerHTML="";Blockly.inject(document.getElementById("blockly"),{path:"",rtl:Game.rtl,toolbox:h,trashcan:true});var b=j.childNodes[0].getElementsByTagName("objectives")[0];Game.verifyButtons(b);hero=new SnackMan(b,j);var e=j.childNodes[0].getElementsByTagName("xml")[0];if(g[2]!=null){Game.nextPartOfMissionLoaded(false,g[2],j,g[3])}else{var i=e.getAttribute("preload");if(i!=null){UserControl.loadAnswer(i,function(l){Game.nextPartOfMissionLoaded(true,l,j,0)})}else{var d=e.outerHTML||(new XMLSerializer()).serializeToString(e);Game.nextPartOfMissionLoaded(true,d,j,0)}}};Game.nextPartOfMissionLoaded=function(f,d,e,c){var b=Blockly.Xml.textToDom(d);MyDomToWorkspace(Blockly.mainWorkspace,b);Game.firstTime=f;var a=function(h){CustomerManager.init(h.childNodes[0].getElementsByTagName("customers")[0],h.childNodes[0].getElementsByTagName("customersSN")[0]);Game.mission=h;Game.reset();Game.bonusTime=h.childNodes[0].getElementsByTagName("objectives")[0].getAttribute("bonusTime");Game.bonusTimeReward=h.childNodes[0].getElementsByTagName("objectives")[0].getAttribute("bonusTimeReward");Game.addCronometro(Game.bonusTime,c);Game.showCountInstructions();window.setTimeout(Game.importPrettify,1);if(f){var g=Explanation.parseUserLogged(e.childNodes[0].getElementsByTagName("explanation")[0]);Explanation.showInfo(g,true)}else{Hints.init(h.getElementsByTagName("hints")[0]);Game.initTime()}};window.setTimeout(function(){a(e)},1000)};Game.verifyButtons=function(a){Game.enabledDebug=a.getAttribute("buttonDebug")!=="false";Game.enabledRun=a.getAttribute("buttonRun")!=="false";Game.enabledVarWindow=a.getAttribute("variableWindow")!=="false";if(!Game.enabledDebug){Game.disableButton("debugButton")}if(!Game.enabledRun){Game.disableButton("runButton")}Game.resetButtons()};Game.timesUp=function(a,b){if(((a*60+b)+30)==Game.bonusTime){Game.changeCSSAlertCronometro()}else{if(((a*60+b))==Game.bonusTime){Game.changeCSSOverCronometro()}}};Game.changeCSSAlertCronometro=function(){var a=$(".digit");a.removeClass("static");a.addClass("alert");a.css("background-color","rgba(230,9,40,1)");Game.cronometro.options.cssDigit="alert"};Game.changeCSSOverCronometro=function(){var a=$(".digit");a.removeClass("alert");a.addClass("over");a.css("background-color","#CFCFC4");Game.cronometro.options.cssDigit="over";Game.cronometro.options.callback=function(){}};Game.addCronometro=function(a,d){$("#timerCountUp").empty();Game.cronometro=null;if(a!=null){d=parseInt(d);$("#timerCountUp").append("<span></span>");Game.cronometro=CountUp($("#timerCountUp span"),{start:d,stopped:true,callback:Game.timesUp});$("#timerCountUp").css("right",$("#logoffButton").width());$("#timerCountUp").css("right",$("#timerCountUp").width());var c=document.getElementById("logoffButton");var b=c.offsetTop+((c.clientHeight-$(".countdownHolder").height())/2);$("#timerCountUp").css("top",b+"px");if(d>Game.bonusTime){Game.changeCSSOverCronometro()}else{if(d+30>=Game.bonusTime){Game.changeCSSAlertCronometro()}}}};Game.initTime=function(){Game.currTime=new Date().getTime();Game.initCronometro();Game.startSaveUserProgress()};Game.initCronometro=function(){if(Game.cronometro!=null){Game.cronometro.restart()}};Game.cleanCronometro=function(){if(Game.cronometro!=null){Game.cronometro.stop();$("#timerCountUp").empty();Game.cronometro=null}};Game.stopCronometro=function(){if(Game.cronometro!=null){Game.cronometro.stop()}};Game.importPrettify=function(){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href","prettify.css");document.head.appendChild(b);var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src","prettify.js");document.head.appendChild(a)};Game.doResizeWindow=function(a){if(Game.variableBox==null){return}if(a!=undefined){Game.variableBox.style.display=a}Game.resizeWindow(null);Blockly.fireUiEvent(window,"resize")};Game.resizeWindow=function(f){var c=document.getElementById("visualization");var d=c.offsetTop;Game.blockly.style.top=Math.max(10,d-window.pageYOffset)+"px";Game.blockly.style.left=Game.rtl?"10px":"380px";var a=window.innerWidth;if(Game.variableBox.style.display==="none"){a-=400}else{Game.blockly.style.height=Game.optResize.blocklyDivH;a-=Game.optResize.blocklyDivW;Game.variableBox.style.top=(Game.optResize.varBoxT?Game.blockly.style.top:(Game.blockly.offsetTop+Game.blockly.offsetHeight+10)+"px");if(Game.optResize.varBoxT){Game.variableBox.style.left=((Game.rtl?10:380)+a+5)+"px";Game.variableBox.style.width="200px"}else{Game.variableBox.style.left=Game.blockly.style.left;Game.variableBox.style.width=Game.blockly.style.width}Game.variableBox.style.height=Game.optResize.varBoxH}Game.blockly.style.width=(a)+"px";var b=document.getElementById("blocklyLock");if(b!==null&&b!=="undefined"&&b!==undefined){b.style.cssText=Game.blockly.style.cssText;b.style.height=Game.blockly.clientHeight+"px";b.style.position="fixed";b.style.backgroundColor="grey";b.style.opacity="0.3"}if(Game.counterInstruction!=null){Game.counterInstruction.style.left=(Game.blockly.offsetLeft+Game.blockly.offsetWidth-Game.counterInstruction.clientWidth-15)+"px"}};Game.moveDownButtonClick=function(){Hints.hideHintWithTimer();Game.varWindow=Game.DOWN;document.getElementById("moveDown").style.display="none";document.getElementById("moveRight").style.display="inline-block";Game.optResize={blocklyDivW:400,blocklyDivH:"70%",varBoxT:false,varBoxH:"20%"};Game.doResizeWindow()};Game.moveRightButtonClick=function(){Hints.hideHintWithTimer();Game.varWindow=Game.RIGHT;document.getElementById("moveRight").style.display="none";document.getElementById("moveDown").style.display="inline-block";Game.optResize={blocklyDivW:600,blocklyDivH:"90%",varBoxT:true,varBoxH:"90%"};Game.doResizeWindow()};Game.reset=function(){Game.stopAlertGoalButton();hero.reset();CustomerManager.reset();Game.display();Game.killAll()};Game.killAll=function(){for(var a=0;a<Game.pidList.length;a++){window.clearTimeout(Game.pidList[a])}Game.pidList=[]};Game.display=function(){CustomerManager.animation();Game.ctxDisplay.drawImage(Game.imgBackground,0,0,352,448);hero.draw(Game.ctxDisplay);CustomerManager.draw(Game.ctxDisplay);showMoney(Game.money,Game.ctxDisplay)};Game.exitCountInstructions;Game.countInstructions=function(g,b){Game.exitCountInstructions=false;var e=0;for(var a=0;a<g.length;a++){var d=g[a];if(d.nextConnection!=null){e++}if(b!=undefined){if(!b(d)){Game.exitCountInstructions=true;return e}}e+=Game.countInstructions(d.childBlocks_,b);if(Game.exitCountInstructions){return e}}return e};Game.goalButtonClick=function(){Hints.stopHints();Blockly.WidgetDiv.hide();Game.stopAlertGoalButton();Explanation.showInfo(Game.mission.childNodes[0].getElementsByTagName("explanation")[0],false)};Game.logoffButtonClick=function(){Hints.stopHints();Game.stopAlertGoalButton();BlocklyApps.hideDialog(false);window.removeEventListener("unload",Game.unload);var a=new Date().getTime();Game.cleanCronometro();$("#vars").datagrid("loadData",{total:0,rows:[]});Game.doResizeWindow("none");Game.killAll();Game.runningStatus=0;var c=null;var b=0;if(Game.currTime!=0){c=Blockly.Xml.domToText(Blockly.Xml.workspaceToDom(Blockly.mainWorkspace));b=Math.floor((a-Game.currTime)/1000)}document.getElementById("blockly").innerHTML="";UserControl.logoff(b,Game.howManyRuns,c,function(){Game.init()})};Game.runButtonClick=function(){Game.disableButton("runButton");Game.enableButton("resetButton");Game.disableButton("debugButton");Game.doResizeWindow("none");Game.saveMoney();Blockly.mainWorkspace.traceOn(true);Game.execute(1)};Game.resetButtonClick=function(){Game.lastErrorData.iderror=0;Game.lastErrorData.message="";Game.lastErrorData.block=null;Hints.stopHints();Game.resetButtons();Game.reset();Game.doResizeWindow("none");Hints.startHints();Game.unlockBlockly();Game.stopAlertGoalButton()};Game.enableButton=function(a){if((a==="debugButton"&&!Game.enabledDebug)||(a==="runButton"&&!Game.enabledRun)){return}var b=document.getElementById(a);b.disabled="";b.className="primary"};Game.disableButton=function(a){var b=document.getElementById(a);b.disabled="disabled";b.className="notEnabled"};Game.firstClick=true;Game.debugButtonClick=function(){Game.disableButton("debugButton");if(Game.runningStatus===0){Game.enableButton("resetButton");if(Game.enabledVarWindow){Game.doResizeWindow("inline");$("#vars").datagrid("resize")}Game.saveMoney();Blockly.mainWorkspace.traceOn(true);Game.firstClick=true}else{Hints.stopHints();Game.firstClick=false;if(!Blockly.mainWorkspace.traceOn_){Blockly.mainWorkspace.traceOn(true)}}Game.execute(2)};Game.resetButtons=function(a){Game.disableButton("resetButton");Game.enableButton("debugButton");Game.enableButton("runButton");if(Blockly.mainWorkspace!=null){Blockly.mainWorkspace.traceOn(false)}Game.runningStatus=0;if(a==undefined||a==true){$("#vars").datagrid("loadData",{total:0,rows:[]})}};Game.execute=function(a){if(Game.runningStatus===0){Game.highlightPause=false;Blockly.hideChaff();Hints.stopHints();Blockly.WidgetDiv.hide();BlocklyApps.log=[];BlocklyApps.ticks=10000;$("#vars").datagrid("loadData",{total:0,rows:[]});Game.reset();try{var d=Blockly.JavaScript;Game.howManyRuns++;Game.saveMission();var b="var NoBugsJavaScript = {};\n"+d.workspaceToCode();Game.jsInterpreter=new NoBugsInterpreter(b,Game.initApi);Game.stepSpeed=1000*Math.pow(0.5,3);Game.lockBlockly()}catch(c){if(c==Infinity){Game.showError("Error_infinityLoopDetected");Game.resetButtons();return}console.log(c)}}Game.runningStatus=a;Game.pidList.push(window.setTimeout(function(){Game.nextStep()},2))};Game.showCountInstructions=function(){if(hero.hasCommQtd||hero.objective.maxCommands>0){var a=document.createElement("div");a.id="countInstruction";a.style.position="absolute";a.style.top=blockly.offsetTop+"px";a.style.backgroundColor="rgba(153, 152, 152, 0.28)";a.style.opacity="0.3";a.innerHTML=Game.countInstructions(Blockly.mainWorkspace.getTopBlocks())+" blocks";document.getElementById("mainBody").appendChild(a);a.style.left=(Game.blockly.offsetLeft+Game.blockly.offsetWidth-a.clientWidth-15)+"px";Game.counterInstruction=a}else{Game.counterInstruction=null}};Game.updateCounterInstructions=function(a){if(Game.counterInstruction==null){return}Game.counterInstruction.innerHTML=a+" blocks";Game.counterInstruction.style.left=(Game.blockly.offsetLeft+Game.blockly.offsetWidth-Game.clientWidth-15)+"px"};Game.lockBlockly=function(){var a=document.createElement("div");a.id="blocklyLock";a.style.cssText=Game.blockly.style.cssText;a.style.height=Game.blockly.clientHeight+"px";a.style.position="fixed";a.style.backgroundColor="grey";a.style.opacity="0.3";var b=document.getElementById("mainBody");b.appendChild(a)};Game.unlockBlockly=function(){var a=document.getElementById("blocklyLock");if(a!==null&&a!=="undefined"&&a!==undefined){var b=document.getElementById("mainBody");b.removeChild(a)}};Game.updateVariables=function(){var b=Game.jsInterpreter.variables.length;var a=[];Game.jsInterpreter.variables.forEach(function(c){var d=c.scope.properties[c.name].data;if(d!=undefined){if(d.type!=undefined){d="<div><p style='margin: 0px' class="+d.type+"><img src='images/"+d.descr+".png'/></p><p style='margin: 0px'>"+BlocklyApps.getMsg("__"+d.sourceType)+" "+CustomerManager.getCustomerPosition(d.source)+"</p></div>"}a.push({name:c.name,value:d})}});$("#vars").datagrid("loadData",{total:b,rows:a})};Game.nextStep=function(){if(Game.runningStatus==0){return}while(true){try{if(Game.jsInterpreter.step()){if(BlocklyApps.log.length>0||Game.highlightPause){if(Game.runningStatus!=2||Game.highlightPause===false){BlocklyApps.log.push(["nextStep"])}else{Game.highlightPause=false;if(Game.firstClick&&Game.runningStatus==2){BlocklyApps.log.push(["nextStep"]);Game.firstClick=false}}Game.pidList.push(window.setTimeout(function(){Game.animate()},10));return}}else{Game.resetButtons();Blockly.mainWorkspace.highlightBlock(null);hero.verifyObjectives("deliver",{allCustomers:true});hero.verifyObjectives("varQtd",null);hero.verifyObjectives("commQtd",null);Game.lastErrorData.block=null;if(hero.allObjectivesAchieved){Game.lastErrorData.iderror=0;Game.lastErrorData.message="";Hints.stopHints();Game.stopCronometro();var f=Blockly.Xml.workspaceToDom(Blockly.mainWorkspace);var g=Game.countInstructions(Blockly.mainWorkspace.getTopBlocks());var a=new Date().getTime();var j=Math.floor((a-Game.currTime)/1000);var b=hero.addReward(g,(Game.cronometro==null?0:Game.cronometro.passed),Game.bonusTime,Game.bonusTimeReward);Game.money=parseInt(Game.money)+b.total;Game.display();var k=Blockly.Xml.domToText(f);UserControl.saveMission(b.total,j,Game.howManyRuns,true,k,function(){var r=BlocklyApps.getMsg("NoBugs_goalAchievedVictory");var t="<img style='vertical-align: middle;' src='images/coin2.png'/>";var m=r.format(b.total+t)+"<br/>";if(b.base!=b.total){var q="<table class='tableVictory' ><tr style='font-weight:bold'><td>"+BlocklyApps.getMsg("Victory_BaseValue")+" </td><td align='right' style='width: 50px;'> "+b.base+"</td></tr>";q=q+"<tr style='font-weight:bold'><td colspan='2'>"+BlocklyApps.getMsg("Victory_Bonus")+"</td></tr>";for(var n=0;n<b.bonus.length;n++){var l=BlocklyApps.getMsg(b.bonus[n].name);var o=l.format(b.bonus[n].extraInfo);q=q+"<tr><td> <img src='images/goal_ok.png'/>&nbsp;"+o+"</td> <td align='right' style='width: 50px;'>"+b.bonus[n].value+"</td></tr>"}m=m+q+"</table>"}var p=document.getElementById("victoyText");p.innerHTML=m;Game.stopAlertGoalButton();MyBlocklyApps.showDialog(document.getElementById("dialogVictory"),null,true,true,true,null,null,function(){window.removeEventListener("unload",Game.unload);try{UserControl.retrieveMissions(function(s){Game.loginData.clazzId=0;Game.logged(s)})}catch(i){Game.init()}})})}else{var e=[];var c=hero.objective.objectives;for(var d=0;d<c.length;d++){e[d]=[Objective.factory(c[d].objective).createExplanationItem(c[d]),c[d].achieved]}UserControl.missionFail(Game.howManyRuns,e);Game.lastErrorData.iderror="missionFail";Game.lastErrorData.message=document.getElementById("dialogFailText");MyBlocklyApps.showDialog(document.getElementById("dialogFail"),null,true,true,true,null,null,function(){Hints.showErrorHint()})}Game.unlockBlockly();return}}catch(h){Game.animate();Game.unlockBlockly();Game.stopAlertGoalButton();Hints.startHints();return}}};Game.logEvent=null;Game.startSaveUserProgress=function(){if(Game.logEvent==null){Game.logEvent=Blockly.addChangeListener(function(){if(Blockly.Block.dragMode_!=0){return}var a=new Date().getTime();var c=0;if(Game.currTime!=0){c=Math.floor(((a)-Game.currTime)/1000)}if(c<10){return}var b="<xml></xml>";if(Blockly.mainWorkspace!=null){b=Blockly.Xml.domToText(Blockly.Xml.workspaceToDom(Blockly.mainWorkspace))}UserControl.saveMission(0,c,Game.howManyRuns,false,b);Game.currTime=a})}};Game.removeChangeListeners=function(){if(Game.logEvent!=null){Blockly.removeChangeListener(Game.logEvent);Game.logEvent=null}if(Hints.evtChangeListener!=null){Blockly.removeChangeListener(Hints.evtChangeListener);Hints.evtChangeListener=null}};Game.initApi=function(a,b){var c=function(){return a.createPrimitive(Game.updateVariables())};a.setProperty(b,"updateVariables",a.createNativeFunction(c));var c=function(d){d=d?d.toString():"";return a.createPrimitive(Game.highlightBlock(d))};a.setProperty(b,"highlightBlock",a.createNativeFunction(c));var c=function(e,d,f){return a.createPrimitive(nobugsComparison(e,d,f))};a.setProperty(b,"nobugsComparison",a.createNativeFunction(c));c=function(d){return a.createPrimitive(hero.goToBarCounter(d))};a.setProperty(b,"goToBarCounter",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.goToDisplay())};a.setProperty(b,"goToDisplay",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.goToCooler())};a.setProperty(b,"goToCooler",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.isThereACustomer())};a.setProperty(b,"isThereACustomer",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.hasHunger())};a.setProperty(b,"hasHunger",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.askForFood())};a.setProperty(b,"askForFood",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.hasThirsty())};a.setProperty(b,"hasThirsty",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.askForDrink())};a.setProperty(b,"askForDrink",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.goToBoxOfFruits())};a.setProperty(b,"goToBoxOfFruits",a.createNativeFunction(c));c=function(){return a.createPrimitive(hero.goToJuiceMachine())};a.setProperty(b,"goToJuiceMachine",a.createNativeFunction(c));c=function(d){return a.createPrimitive(hero.catchFruits(d))};a.setProperty(b,"catchFruits",a.createNativeFunction(c));c=function(d){return a.createPrimitive(hero.prepareAndCatchJuice(d))};a.setProperty(b,"prepareAndCatchJuice",a.createNativeFunction(c));c=function(d){return a.createPrimitive(hero.catchFood(d))};a.setProperty(b,"catchFood",a.createNativeFunction(c));c=function(d){return a.createPrimitive(hero.catchDrink(d))};a.setProperty(b,"catchDrink",a.createNativeFunction(c));c=function(d){return a.createPrimitive(hero.deliver(d))};a.setProperty(b,"deliver",a.createNativeFunction(c))};Game.highlightPause=false;Game.highlightBlock=function(a){BlocklyApps.log.push(["IM",0]);CustomerManager.update();Blockly.mainWorkspace.highlightBlock(a);if(Game.runningStatus===2){Game.updateVariables()}Game.highlightPause=true};Game.animate=function(){var a=BlocklyApps.log.shift();if(!a){if(Game.runningStatus==2){Game.enableButton("debugButton");Hints.startHints()}return}var b=a.shift();if(b==="nextStep"){Game.pidList.push(window.setTimeout(Game.nextStep,1));return}if(Game.step(b,a)){Game.stepSpeed=1000*Math.pow(1-Game.speedSlider.getValue(),3);Game.pidList.push(window.setTimeout(function(){Game.animate()},Game.stepSpeed))}else{Game.resetButtons(false);Blockly.mainWorkspace.highlightBlock(null)}};Game.step=function(c,a){switch(c){case"AL":hero.alertRun(a);break;case"CO":hero.checkObjectives();case"IM":hero.changeSnackManImage(a);break;case"MS":hero.changeSnackManPosition(a.shift(),a.shift(),a.shift(),a.shift());break;case"OC":hero.nextOpenCoolerImage();break;case"CC":hero.nextCloseCoolerImage();break;case"OD":hero.nextOpenDisplayImage();break;case"CD":hero.nextCloseDisplayImage();break;case"IP":hero.changeImagePlatter();break;case"IO":var b=a.shift();if(b!=null){Game.money+=b}b=a.shift();if(b==0){hero.changeImageOriginal()}break;case"SF":hero.nextShowFruitImage();break;case"HF":hero.nextHideFruitImage();break;case"MJ":hero.nextShowJuiceMachineImage();break;case"HJ":hero.nextHideJuiceMachineImage();break;case"fail":Game.showError(a);return false}return true};Game.showError=function(c){Hints.stopHintsEx();Game.lastErrorData.iderror=c[0];var e=document.getElementById("dialogError");var a=document.getElementById("dialogErrorText");a.textContent=BlocklyApps.getMsg(c[0]);Game.lastErrorData.block=Blockly.selected;Game.lastErrorData.message=a.textContent;UserControl.missionError(Game.howManyRuns,c[0],Blockly.selected.id,a.textContent);var d={top:"120px"};d[Blockly.RTL?"right":"left"]="215px";var b=Blockly.mainWorkspace.topBlocks_[Blockly.mainWorkspace.topBlocks_.length-1].getSvgRoot();BlocklyApps.showDialog(e,b,true,true,d,function(){Hints.startHintsEx()})};Game.lastErrorHas=function(b){if(Game.lastErrorData.block==null){return}var a=Game.lastErrorData.block.inputList;for(var c=0;c<a.length;c++){if(a[c].connection!=null){if(a[c].connection.targetConnection!=null){if(a[c].connection.targetConnection.sourceBlock_.type===b){return true}}}}return false};Game.saveMoney=function(){this.currentlyMoney=this.money};Game.alertColor=["#DD4B39","#E07c70","#edcdc9","#E07c70"];Game.handleAlertTimer=0;Game.alertGoalButton=function(){if(Game.handleAlertTimer!=0){return}Game.alertControl=0;Game.handleAlertTimer=window.setInterval(function(){var a=document.getElementById("goalButton");Game.alertControl=(Game.alertControl+1)%4;a.style.backgroundColor=Game.alertColor[Game.alertControl]},300)};Game.stopAlertGoalButton=function(){if(Game.handleAlertTimer==0){return}window.clearInterval(Game.handleAlertTimer);Game.handleAlertTimer=0;var a=document.getElementById("goalButton");a.style.backgroundColor="#DD4B39"};var Explanation={};Explanation.selectCommands=function(a){var c={};var d=a.firstElementChild;while(d!=null){var b=d.getAttribute("show");if(b!=null){c[d.getAttribute("name")]=b==="true"}d=d.nextElementSibling}return c};Explanation.showInfo=function(a,g,f){var e=0;Explanation.firstStatement=-1;var c=a.firstElementChild;var b=0;while(c!=null){var d=c.getAttribute("type");if(d==="statement"){if(e==0){Explanation.firstStatement=b}e++;Explanation.lastStatement=b}c=c.nextElementSibling;b++}if(Explanation.firstStatement==-1){return}Explanation.explanation=a;if(g){Explanation.pageNumber=Explanation.firstStatement;Explanation.createDialog(Explanation.firstStatement,f)}else{Explanation.pageNumber=Explanation.lastStatement;Explanation.createDialog(Explanation.lastStatement,f)}Explanation.showHint=g;Explanation.hintNumber=-1};Explanation.nextStatement=function(){BlocklyApps.hideDialog(false);var a=Explanation.explanation;var c=a.getElementsByTagName("page");var b=Explanation.pageNumber+1;Explanation.pageNumber=-1;for(;b<=Explanation.lastStatement;b++){var d=c[b].getAttribute("type");if(d==="statement"){if(Explanation.pageNumber==-1){Explanation.pageNumber=b}}}Explanation.createDialog(Explanation.pageNumber)};Explanation.previousStatement=function(){BlocklyApps.hideDialog(false);var a=Explanation.explanation;var c=a.getElementsByTagName("page");var b=Explanation.pageNumber-1;Explanation.pageNumber=-1;for(;b>=0;b--){var d=c[b].getAttribute("type");if(d==="statement"){if(Explanation.pageNumber==-1){Explanation.pageNumber=b}}}Explanation.createDialog(Explanation.pageNumber)};Explanation.createDialog=function(h,g){var e=document.getElementById("dialogInfo");var a=document.getElementById("dialogInfoText");var b=Explanation.explanation.getElementsByTagName("page");a.innerHTML=b[h].innerHTML||b[h].textContent;var d=document.getElementById("dialogInfoButton");var f=Explanation.firstStatement==Explanation.lastStatement;d.innerHTML=(f?nobugspage.finishButton(null,null,null):(h==Explanation.firstStatement?nobugspage.nextButton(null,null,null):nobugspage.previousButton(null,null,null)+(h==Explanation.lastStatement?nobugspage.finishButton(null,null,null):nobugspage.nextButton(null,null,null))));Explanation.evaluateObjectives(h,a);var c={top:"120px"};c[Blockly.RTL?"right":"left"]="215px";MyBlocklyApps.showDialog(e,(h==0?document.getElementById("goalButton"):null),true,true,true,Game.missionTitle,c,g)};Explanation.evaluateObjectives=function(l,c){if(l!=Explanation.lastStatement){return}var j=document.createElement("ul");c.appendChild(j);var f=hero.objective.objectives;for(var h=0;h<f.length;h++){var g=document.createElement("li");var o=f[h].objective;g.className="goal"+(f[h].achieved?"ok":"cancel");g.innerHTML=Objective.factory(o).createExplanationItem(f[h]);j.appendChild(g)}var p=document.createElement("table");var k=document.createElement("tr");var b=document.createElement("td");b.style.border="1px solid #FF0";b.style.padding="3px";b.style.backgroundColor="#F3F3CA";k.appendChild(b);p.appendChild(k);c.appendChild(p);var d=BlocklyApps.getMsg("rewardExplanation");var n="<img style='vertical-align: middle;' src='images/coin2.png'/>";var e=d.format(hero.objective.reward+n)+"<br/>";if(hero.objective.maxCommandsReward>0){d=BlocklyApps.getMsg("commandBonusExplanation");e=e+d.format(hero.objective.maxCommandsReward+n,hero.objective.maxCommands)}if(Game.bonusTime!=null){d=BlocklyApps.getMsg("timeBonusExplanation");var m=Game.bonusTimeReward.split(" ");e=e+d.format(m[m.length-1]+n,Game.bonusTime/60)}b.innerHTML=e};Explanation.finishStatement=function(){BlocklyApps.hideDialog(false);if(!Explanation.showHint){Hints.startHints();return}Hints.init(Game.mission.getElementsByTagName("hints")[0]);Game.initTime()};Explanation.parseUserLogged=function(explanations){var children=explanations.getElementsByTagName("page");var userLogged=Game.loginData.userLogged;for(var j=0;j<children.length;j++){var e=innerXML(children[j]);do{var i=e.indexOf("$${");if(i==-1){break}var e1=e.substring(i+3);var e2=e1.substring(0,e1.indexOf("}"));var e3=eval(e2);e=e.substring(0,i)+e3+e.substring(e.indexOf("}")+1)}while(true);if(children[j].innerHTML){children[j].innerHTML=e}else{children[j].textContent=e}}return explanations};var Hints={};Hints.Categories=[];Hints.chooseCategoryCalled=false;Hints.bindEvent1=null;Hints.bindEvents=[];Hints.TIMEINTERVAL=3000;Hints.lastTimeSpent=0;Hints.hndlTimer=0;Hints.lastCountBlocks=0;Hints.hintBlockDeleted=null;Hints.evtChangeListener=null;Hints.specialControl=false;Hints.menuOpened=false;Hints.beforeHideChaff=null;var countInstructions,countTopInstructions,menuSelected;Hints.init=function(b){Hints.hints={sequence:[],whenError:[]};Hints.showedIddle=0;Hints.hintBlockDeleted=null;Hints.lastInsertedBlock=null;Hints.activeBlock=null;Hints.lastCountBlocks=Game.countInstructions(Blockly.mainWorkspace.getTopBlocks());if(Hints.evtChangeListener==null){Hints.evtChangeListener=Blockly.addChangeListener(Hints.changeListener)}if(b!=null){var a=b.getElementsByTagName("sequence");if(a!=null&&a.length>0){Hints.hints.sequence=Hints.traverseHints(a[0].firstElementChild,false)}a=b.getElementsByTagName("errors");if(a!=null&&a.length>0){Hints.hints.whenError=Hints.traverseHints(a[0].firstElementChild,true)}}Hints.addDefaultErrorHints();if(Hints.hints.sequence.length>0){Hints.launchTimer(Hints.hints.sequence[0].time)}Blockly.bindEvent_(Blockly.Toolbox.HtmlDiv,"mousedown",null,Hints.menuEvent);if(Hints.beforeHideChaff==null){Hints.beforeHideChaff=Blockly.hideChaff;Blockly.hideChaff=Hints.hideChaff}};Hints.menuEvent=function(){Hints.menuOpened=Blockly.Toolbox.tree_.selectedItem_!=null};Hints.hideChaff=function(a){Hints.beforeHideChaff(a);Hints.menuOpened=false};Hints.addDefaultErrorHints=function(){var a={};a.content=document.getElementById("Hints_DebugButtonError").innerHTML;a.time=0;a.running=false;a.category="DebugProgram";a.condition="Game.howManyRuns > 2 && "+Hints.Categories[a.category].naturalCondition;Hints.hints.whenError.push(a);a.next=new Object();a=a.next;a.content=document.getElementById("Hints_GoalButtonError").innerHTML;a.time=0;a.condition="true";a.running=false;a.category="GoalButton";Hints.hints.whenError.push(a);a=new Object();a.category="TestBlock";a.content=document.getElementById("Hints_EmptyInputError").innerHTML;a.time=7000;a.running=false;a.condition="Hints.hasEmptyInputs()";Hints.hints.sequence.push(a)};Hints.formatCategory=function(b){var a=b.category;if(a.indexOf("(")>0){b.args=a.substring(a.indexOf("("));b.args=b.args.substring(1,b.args.length-1);b.args=b.args.split(",");b.category=a.substring(0,a.indexOf("("))}};Hints.traverseHints=function(j,c){var b=[];var f=null;var e=null;while(j){e={};e.type=j.tagName;e.category=j.getAttribute("category");Hints.formatCategory(e);e.content=j.innerHTML||j.textContent;if(e.content.length==0){e.content=null}e.imghex=j.getElementsByTagName("imghex");if((e.imghex!=null||e.imghex!=undefined)&&e.imghex.length>0){var a=[];var g=[];for(var d=0;d<e.imghex.length;d++){a.push(e.imghex[d].getAttribute("id"));g.push(e.imghex[d].textContent)}UserControl.existsImageKey(a,{async:false,callback:function(k){for(var l=0;l<k.length;l++){if(!k[l]){UserControl.convertHexToImage(a[l],g[l])}var h=' <img src="hintimg?i='+a[l]+'"/>';e.content=e.content.replace('<imghex id="'+a[l]+'"><![CDATA['+g[l]+"]]></imghex>",h)}}})}e.time=j.getAttribute("time");if(e.time==null){e.time=Hints.TIMEINTERVAL}e.time=parseInt(e.time);e.condition=(j.getAttribute("condition"));if(e.condition==null){e.condition=Hints.Categories[e.category].condition}if(e.condition==undefined){e.condition="true"}if(Hints.Categories[e.category].naturalCondition!=undefined){e.condition=Hints.Categories[e.category].naturalCondition+" && "+e.condition}e.running=j.getAttribute("running");if(e.running==null){e.running=Hints.Categories[e.category].running}if(e.running==null||e.running==undefined){e.running=false}j=j.nextElementSibling;if(e.category==="BlockDeleted"&&Hints.hintBlockDeleted==null){Hints.hintBlockDeleted=e;continue}if(f!=null){f.next=e}f=e;b.push(e)}return b};Hints.showErrorHint=function(){var countInstructions=Game.countInstructions(Blockly.mainWorkspace.getTopBlocks());Hints.hintSelected=null;var hintErrors=Hints.hints.whenError;for(var i=0;i<hintErrors.length;i++){var hint=hintErrors[i];Hints.hintSelected=hint;var condition=eval(hint.condition);if(condition){var cat=Hints.Categories[hint.category];cat.show(hint.args);Hints.associateHideEvents(null,(cat.specialEvent!=undefined?cat.specialEvent():null));break}}};Hints.timeIsUp=function(){if(Hints.hndlTimer==0){return}Hints.hndlTimer=0;var b=Hints.hints.sequence;if(b.length==0){return}if(Blockly.Block.dragMode_>0){Hints.launchTimer(Hints.TIMEINTERVAL);return}var c=Blockly.mainWorkspace.getTopBlocks();countInstructions=Game.countInstructions(c);countTopInstructions=c.length;menuSelected=Blockly.Toolbox.tree_.selectedItem_;if(menuSelected!=null){menuSelected=menuSelected.element_}Hints.hintSelected=null;for(var a=0;a<b.length;a++){if(Hints.runHint(b[a])){return}}Hints.launchTimer(Hints.TIMEINTERVAL)};Hints.runHint=function(hint){Hints.hintSelected=hint;if(Game.runningStatus>0&&!hint.running){return false}if(hint.category==="TestBlock"){Hints.foundTestBlock=false;Game.countInstructions(Blockly.mainWorkspace.getTopBlocks(),Hints.visitBlocks);if(Hints.foundTestBlock){return true}return false}var condition=eval(hint.condition);var cat=Hints.Categories[hint.category];if(condition&&Hints.showOnMenu(cat)){if(Hints.lastTimeSpent<hint.time){Hints.hndlTimer=window.setTimeout(Hints.showHint.bind(window,hint),hint.time-Hints.lastTimeSpent);Hints.lastTimeSpent=hint.time}else{Hints.showHint(hint)}return true}return false};Hints.showHint=function(b){Hints.hintSelected=b;var a=Hints.Categories[b.category];a.show(b.args);Hints.associateHideEvents(a.bindEvent,(a.specialEvent!=undefined?a.specialEvent():null))};Hints.launchTimer=function(a){if(Hints.hndlTimer==0){Hints.hndlTimer=window.setTimeout(Hints.timeIsUp,a);Hints.lastTimeSpent=a}};Hints.showOnMenu=function(b){if(!Hints.menuOpened){return true}var a=b.hideOnMenu;if(a==undefined){a=true}return !a};Hints.visitBlocks=function(block){Hints.activeBlock=block;var hint=Hints.hintSelected;var condition=eval(hint.condition);var cat=Hints.Categories[hint.category];if(condition&&Hints.showOnMenu(cat)){Hints.foundTestBlock=true;cat.show(hint.args);Hints.associateHideEvents(cat.bindEvent,(cat.specialEvent!=undefined?cat.specialEvent():null));return false}Hints.activeBlock=null;return true};Hints.associateHideEvents=function(b,a){if(b==undefined||b==null){b=Hints.hideHintWithTimer}Hints.bindEvent1=Blockly.addChangeListener(b);Hints.bindEvents.push(Blockly.bindEvent_(Blockly.Toolbox.HtmlDiv,"mousedown",null,b));Hints.bindEvents.push(Blockly.bindEvent_(Blockly.svg,"mousedown",null,b));Hints.bindEvents.push(Blockly.bindEvent_(window,"showWindowPrompt",null,b));if(a!=null){Hints.bindEvents.push(a)}Hints.bindEvents.push(Blockly.bindEvent_(Blockly.mainWorkspace.scrollbar.hScroll.svgBackground_,"mousedown",null,b));Hints.bindEvents.push(Blockly.bindEvent_(Blockly.mainWorkspace.scrollbar.hScroll.svgKnob_,"mousedown",null,b));Hints.bindEvents.push(Blockly.bindEvent_(Blockly.mainWorkspace.scrollbar.vScroll.svgBackground_,"mousedown",null,b));Hints.bindEvents.push(Blockly.bindEvent_(Blockly.mainWorkspace.scrollbar.vScroll.svgKnob_,"mousedown",null,b));Hints.bindEvents.push(Blockly.bindEvent_(Game.slider.svg,"mousedown",null,b))};Hints.hideHintWithTimer=function(){Hints.stopHints();Hints.launchTimer((Hints.hintSelected==null||Hints.hintSelected.next==null?Hints.TIMEINTERVAL:Hints.hintSelected.next.time))};Hints.hideHints=function(){MyBlocklyApps.hideDialog(false);if(Hints.bindEvent1!=null){Blockly.removeChangeListener(Hints.bindEvent1);Hints.bindEvent1=null}while(Hints.bindEvents.length>0){Blockly.unbindEvent_(Hints.bindEvents[0]);Hints.bindEvents.shift()}};Hints.startHints=function(){if(Hints.specialControl){return}Hints.showedErrorHint=false;Hints.launchTimer(Hints.TIMEINTERVAL)};Hints.stopHints=function(){window.clearTimeout(Hints.hndlTimer);Hints.hideHints();Hints.hndlTimer=0};Hints.startHintsEx=function(){Hints.specialControl=false;Hints.startHints()};Hints.stopHintsEx=function(){Hints.stopHints();Hints.specialControl=true};Hints.changeListener=function(){var a=Game.countInstructions(Blockly.mainWorkspace.getTopBlocks());Game.updateCounterInstructions(a);if(a>Hints.lastCountBlocks){Hints.lastInsertedBlock=Blockly.selected}else{if(a<Hints.lastCountBlocks){Hints.lastInsertedBlock=null;if(Hints.hintBlockDeleted!=null){Hints.runHint(Hints.hintBlockDeleted)}}}Hints.activeBlock=Hints.lastInsertedBlock;Hints.lastCountBlocks=a};function calcTop(a){return a.offsetTop+a.offsetParent.offsetTop+a.offsetParent.offsetParent.offsetTop}function calcLeft(a){return a.offsetLeft+a.offsetParent.offsetLeft+a.offsetParent.offsetParent.offsetLeft}function createLeftDlg(h,f){document.getElementById("LeftHintText").innerHTML=f;var d=calcTop(h);var g=calcLeft(h);var b=h.clientWidth;var c={};c.width="300px";c.top=d+"px";c.left=(g+b)+"px";var a=document.getElementById("LeftHint");BlocklyApps.showDialog(a,null,false,false,c,null)}function createStyle(g,f,a){var h=BlocklyApps.getBBox_(g);var c=h.y;var d=h.x;var b={};b.width="500px";b.top=(c+f)+"px";b.left=(d-(a.clientWidth/2))+"px";return b}function createStylePosition(d,b,a){var c=Blockly.Toolbox.tree_.children_[d].element_;c=Blockly.Toolbox.flyout_.workspace_.getTopBlocks(true)[b];if(c==undefined){return[]}Hints.hintSelected.e=c;return[createStyle(c.getSvgRoot(),c.svg_.height,a),c.svg_.getRootElement()]}function createDownDlg(e,d,a){var b=document.getElementById("DownHint");var f=document.getElementById("DownHintText");f.innerHTML=a;var c={};c.top=(d-130)+"px";c.left=e+"px";c.width="550px";BlocklyApps.showDialog(b,null,false,false,c,null)}function createDownDlgByButton(c,a){var b=document.getElementById(c);var d=BlocklyApps.getBBox_(b);createDownDlg(d.x,d.y,a);return b}function createRightDlg(a,f,e){var b=document.getElementById("RightHint");var d=document.getElementById("RightHintText");d.innerHTML=e;var c={};c.width="300px";c.top=f+"px";c.left=(a-325)+"px";BlocklyApps.showDialog(b,null,false,false,c,null)}function createInfoDlg(d,b,e){var c=document.getElementById("dialogHint");var a=document.getElementById("dialogHintText");a.innerHTML=d;MyBlocklyApps.showDialog(c,null,true,false,false,e,b,null)}Hints.fCountVariable=function(a){if(a.type==="variables_set"){Hints.totalVariable++}return true};Hints.countVariable=function(){Hints.totalVariable=0;Game.countInstructions(Blockly.mainWorkspace.getTopBlocks(),Hints.fCountVariable);return Hints.totalVariable};Hints.isVariable=function(){return(Hints.activeBlock!=null&&Hints.activeBlock.type=="variables_set")};Hints.variableName=function(){return Hints.activeBlock.getVars()[0]};Hints.hasEmptyInputs=function(){if(Hints.activeBlock==Hints.lastInsertedBlock){return false}var a=Hints.activeBlock.inputList;for(var b=0;b<a.length;b++){if(a[b].connection!=null){if(a[b].connection.targetConnection==null){return true}Hints.activeBlock=a[b].connection.targetConnection.sourceBlock_;if(Hints.hasEmptyInputs()){return true}}}return false};Hints.fCountVariableName=function(b){if(b.type==="variables_set"){var c=b.getVars()[0];for(var a=0;a<Hints.variablesNames.length;a++){if(Hints.variablesNames[a]===c){return true}}Hints.variablesNames.push(c)}return true};Hints.countVariableName=function(){Hints.variablesNames=[];Game.countInstructions(Blockly.mainWorkspace.getTopBlocks(),Hints.fCountVariableName);return Hints.variablesNames.length};Hints.Categories.ChooseCategory={show:function(c){Hints.hintSelected.e=Blockly.Toolbox.tree_.children_[parseInt(c[0])].element_;var b=Hints.hintSelected.e.firstChild.childNodes[2].textContent;var a=null;if(Hints.hintSelected.content==null){Hints.hintSelected.content=BlocklyApps.getMsg("Hints_ChooseCategory");Hints.hintSelected.content=Hints.hintSelected.content.format(b)}a=Hints.hintSelected.content;createLeftDlg(Hints.hintSelected.e,a)},condition:"countInstructions == 0",naturalCondition:"(Hints.chooseCategoryCalled == false) && (Blockly.Toolbox.tree_.children_[parseInt(Hints.hintSelected.args[0])].element_ != menuSelected)",specialEvent:function(){return Blockly.bindEvent_(Hints.hintSelected.e,"mousedown",null,Hints.Categories.ChooseCategory.onselect)},onselect:function(){Hints.chooseCategoryCalled=true;Hints.hideHintWithTimer()},hideOnMenu:false};Hints.Categories.SelectCommand={show:function(c){var b=document.getElementById("SelectCommand");var a=createStylePosition(parseInt(c[0]),parseInt(c[1]),b);if(a.length>0){BlocklyApps.showDialog(b,null,false,false,a[0],null);Hints.chooseCategoryCalled=true}else{Hints.Categories.SelectCommand.bindEvent()}},condition:"countInstructions == 0",naturalCondition:"(Hints.chooseCategoryCalled == true || (Blockly.Toolbox.tree_.children_[parseInt(Hints.hintSelected.args[0])].element_ == menuSelected))",bindEvent:function(){Hints.chooseCategoryCalled=false;Hints.hideHintWithTimer()},hideOnMenu:false};Hints.Categories.StackTogether={show:function(e){var b=document.getElementById("StackTogether");var d=Blockly.mainWorkspace.topBlocks_;for(var a=0;a<d.length;a++){if(d[a].type===e[2]){if(d[a].childBlocks_.length>1){return null}else{Blockly.Toolbox.tree_.setSelectedItem(Blockly.Toolbox.tree_.children_[parseInt(e[0])]);var c=createStylePosition(parseInt(e[0]),parseInt(e[1]),b);BlocklyApps.showDialog(b,null,false,false,c[0],null);return c[1]}}}},condition:"countInstructions == 1",hideOnMenu:false};Hints.Categories.RunProgram={show:function(a){if(Hints.hintSelected.content==null){Hints.hintSelected.content=document.getElementById("Hints_RunProgram").innerHTML}return createDownDlgByButton("runButton",Hints.hintSelected.content)},condition:"Game.howManyRuns == 0",naturalCondition:"countInstructions > 0"};Hints.Categories.DebugProgram={show:function(a){if(Hints.hintSelected.content==null){Hints.hintSelected.content=document.getElementById("Hints_DebugProgram").innerHTML}return createDownDlgByButton("debugButton",Hints.hintSelected.content)},condition:"Game.howManyRuns == 0",naturalCondition:"Game.enabledDebug == true && countInstructions > 0",running:true};Hints.Categories.GoalButton={show:function(a){if(Hints.hintSelected.content==null){Hints.hintSelected.content=document.getElementById("Hints_GoalButton").innerHTML}return createDownDlgByButton("goalButton",Hints.hintSelected.content)},condition:"Game.howManyRuns > 2"};Hints.Categories.SourceCode={show:function(a){var b=BlocklyApps.getBBox_(Blockly.mainWorkspace.topBlocks_[0].getSvgRoot());createRightDlg(b.x,b.y,Hints.hintSelected.content)},condition:"true"};Hints.Categories.WhileDebugging={show:function(a){if(Hints.hintSelected.content==null){Hints.hintSelected.content=document.getElementById("Hints_WhileDebugging").innerHTML}Hints.Categories.SourceCode.show()},naturalCondition:"Game.runningStatus == 2",running:true};Hints.Categories.VariableWindow={show:function(b){if(Hints.hintSelected.content==null){Hints.hintSelected.content=document.getElementById("Hints_VariableWindow").innerHTML}var a=parseInt(Game.variableBox.style.left.replace("px",""));var c=parseInt(Game.variableBox.style.top.replace("px",""));if(Game.varWindow==Game.RIGHT){createRightDlg(a,c,Hints.hintSelected.content)}else{createDownDlg(a,c,Hints.hintSelected.content)}},naturalCondition:"Game.runningStatus == 2 && Game.enabledVarWindow == true && Hints.Categories['VariableWindow'].thereAreVariable()",running:true,thereAreVariable:function(){var c=Game.jsInterpreter.variables;for(var a=0;a<c.length;a++){var b=c[a].scope.properties[c[a].name].data;if(b!=undefined){return true}}return false}};Hints.Categories.LastBlockInserted={show:function(a){var b=BlocklyApps.getBBox_(Hints.lastInsertedBlock.getSvgRoot());createRightDlg(b.x,b.y,Hints.hintSelected.content)},naturalCondition:"Hints.lastInsertedBlock != null"};Hints.Categories.TestBlock={show:function(a){Blockly.mainWorkspace.traceOn(true);Blockly.mainWorkspace.highlightBlock(Hints.activeBlock.id);var b=BlocklyApps.getBBox_(Hints.activeBlock.getSvgRoot());createRightDlg(b.x,b.y,Hints.hintSelected.content)}};Hints.showedIddle=0;Hints.Categories.Iddle={show:function(b){var c=BlocklyApps.getBBox_(Blockly.mainWorkspace.topBlocks_[0].getSvgRoot());var a={top:"120px"};a[Blockly.RTL?"right":"left"]=(c.x-500)+"px";a.width="440px";createInfoDlg(Hints.hintSelected.content,a,Game.missionTitle);Hints.showedIddle++},naturalCondition:"(Blockly.mainWorkspace.topBlocks_.length > 0)"};Hints.Categories.BlockDeleted={show:function(b){var a={top:"120px"};a.width="440px";createInfoDlg(Hints.hintSelected.content,a,Game.missionTitle)}};Hints.showedErrorHint=false;Hints.Categories.LastError={show:function(a){var b=BlocklyApps.getBBox_(Game.lastErrorData.block.getSvgRoot());createRightDlg(b.x,b.y,Hints.hintSelected.content);Hints.showedErrorHint=true},naturalCondition:"(!Hints.showedErrorHint && Game.lastErrorData.block != null)"};Hints.showedCountInstrutionsHint=false;Hints.Categories.ShowCountInstructions={show:function(a){if(Hints.hintSelected.content==null){Hints.hintSelected.content=document.getElementById("Hints_ShowCountInstructions").innerHTML}var b=BlocklyApps.getBBox_(Game.counterInstruction);createRightDlg(b.x,b.y,Hints.hintSelected.content);Hints.showedCountInstrutionsHint=true},naturalCondition:"(Game.firstTime && !Hints.showedCountInstrutionsHint)"};Hints.Categories.Slider={show:function(a){Game.slider.svg.style.visibility="visible";if(Hints.hintSelected.content==null){Hints.hintSelected.content=document.getElementById("NoBugs_slider").innerHTML}var b=BlocklyApps.getBBox_(document.getElementById("divslider"));createDownDlg(b.x,b.y,Hints.hintSelected.content)},naturalCondition:"Game.howManyRuns >= Game.slider.timesBefore && Game.slider.svg.style.visibility == 'hidden'"};var MyBlocklyApps={};MyBlocklyApps.showDialog=function(g,k,c,m,h,j,b,n){if(BlocklyApps.isDialogVisible_){MyBlocklyApps.hideDialog(false)}BlocklyApps.isDialogVisible_=true;BlocklyApps.dialogOrigin_=k;BlocklyApps.dialogDispose_=n;var i=document.getElementById("dialog");i.style.width="auto";i.style.height="auto";var l=document.getElementById("dialogShadow");var e=document.getElementById("dialogBorder");for(var a in b){i.style[a]=b[a]}if(m){l.style.visibility="visible";l.style.opacity=0.3;var f=document.createElement("div");f.id="dialogHeader";if(j!=null){f.innerHTML="<b>"+j+"</b>"}i.appendChild(f);BlocklyApps.dialogMouseDownWrapper_=Blockly.bindEvent_(f,"mousedown",null,BlocklyApps.dialogMouseDown_)}i.appendChild(g);g.className=g.className.replace("dialogHiddenContent","");if(h){i.style.top=Math.max(0,((window.innerHeight-i.clientHeight)/2))+"px";i.style.left=Math.max(0,((window.innerWidth-i.clientWidth)/2))+"px"}function d(){if(BlocklyApps.isDialogVisible_){i.style.visibility="visible";i.style.zIndex=1;e.style.visibility="hidden"}}if(c&&k){BlocklyApps.matchBorder_(k,false,0.2);BlocklyApps.matchBorder_(i,true,0.8);window.setTimeout(d,175)}else{d()}};MyBlocklyApps.hideDialog=function(f){if(!BlocklyApps.isDialogVisible_){return}BlocklyApps.dialogUnbindDragEvents_();if(BlocklyApps.dialogMouseDownWrapper_){Blockly.unbindEvent_(BlocklyApps.dialogMouseDownWrapper_);BlocklyApps.dialogMouseDownWrapper_=null}BlocklyApps.isDialogVisible_=false;var a=(f===false)?null:BlocklyApps.dialogOrigin_;var c=document.getElementById("dialog");var h=document.getElementById("dialogShadow");var b=document.getElementById("dialogBorder");h.style.opacity=0;function d(){h.style.visibility="hidden";b.style.visibility="hidden"}if(a){BlocklyApps.matchBorder_(c,false,0.8);BlocklyApps.matchBorder_(a,true,0.2);window.setTimeout(d,175)}else{d()}c.style.visibility="hidden";c.style.zIndex=-1;var g=document.getElementById("dialogHeader");if(g){g.parentNode.removeChild(g)}while(c.firstChild){var e=c.firstChild;e.className+=" dialogHiddenContent";document.body.appendChild(e)}BlocklyApps.dialogDispose_&&BlocklyApps.dialogDispose_();BlocklyApps.dialogDispose_=null};"use strict";var Graph=(function(f){var h=function(k){var j=[],i=null;for(i in k){Object.prototype.hasOwnProperty.call(k,i)&&j.push(i)}return j};var g=function(j,i){return parseFloat(j)-parseFloat(i)};var e=function(w,k,i,x){x=x||Infinity;var l={},n={"0":[k]},j={},o;var p=function(C,B){var A=""+C;if(!n[A]){n[A]=[]}n[A].push(B)};l[k]=0;while(n){if(!(o=h(n)).length){break}o.sort(g);var y=o[0],z=n[y],r=z.shift(),m=parseFloat(y),q=w[r]||{};if(!z.length){delete n[y]}for(var u in q){if(Object.prototype.hasOwnProperty.call(q,u)){var v=q[u],t=v+m,s=l[u];if((s===f)||(s>t)){l[u]=t;p(t,u);j[u]=r}}}}if(l[i]===f){return null}else{return j}};var a=function(l,i){var j=[],k=i;while(k){j.push(k);k=l[k]}j.reverse();return j};var d=function(l,j){var o=j.shift(),i,n,k=[],m;while(j.length){i=j.shift();n=e(l,o,i);if(n){m=a(n,i);if(j.length){k.push.apply(k,m.slice(0,-1))}else{return k.concat(m)}}else{return null}o=i}};var c=function(n,p){try{return Array.prototype.slice.call(n,p)}catch(o){var k=[];for(var m=p||0,j=n.length;m<j;++m){k.push(n[m])}return k}};var b=function(i){this.map=i};b.prototype.findShortestPath=function(j,i){if(Object.prototype.toString.call(j)==="[object Array]"){return d(this.map,j)}else{if(arguments.length===2){return d(this.map,[j,i])}else{return d(this.map,c(arguments))}}};b.findShortestPath=function(j,k,i){if(Object.prototype.toString.call(k)==="[object Array]"){return d(j,k)}else{if(arguments.length===3){return d(j,[k,i])}else{return d(j,c(arguments,1))}}};return b})();"use strict";var SnackMan={};PreloadImgs.put("$cooker","images/$cooker.png");PreloadImgs.put("$cooker_platter","images/$cooker_platter.png");PreloadImgs.put("cooler","images/cooler.png");PreloadImgs.put("display","images/display.png");PreloadImgs.put("boxoffruits","images/boxoffruits.png");PreloadImgs.put("juicemachine","images/juicemachine.png");SnackMan=function(d,k){var j=k.childNodes[0].getElementsByTagName("cooker")[0].childNodes[0].nodeValue;this.path={n2:{n1:1,n3:1},n3:{n2:1,n4:1},n4:{n3:1,n5:1},n5:{n4:1,n6:1},n6:{n5:1,n7:1},n7:{n6:1,n8:1},n8:{n7:1,n9:1},n9:{n8:1,n10:1},n10:{n9:1,n11:1},n12:{n11:1,n13:1},n13:{n12:1,n14:1},n14:{n13:1,n15:1},n15:{n14:1,n16:1},n16:{n15:1,n17:1},n17:{n16:1,n18:1},n18:{n17:1,n19:1},n19:{n18:1,n20:1},n20:{n19:1,n21:1},n22:{n21:0.5,n23:0.5},n23:{n22:0.5,n24:0.5},n24:{n23:0.5,n25:0.5},n25:{n24:0.5,n26:0.5},n26:{n25:0.5,n27:0.5},n27:{n26:0.5,n28:0.5},n28:{n27:0.5,n29:0.5},n29:{n28:0.5,n30:0.5},n30:{n29:0.5,n31:0.5},n32:{n31:1,n33:1},n33:{n32:1,n34:1},n34:{n33:1,n35:1},n35:{n34:1,n36:1},n36:{n35:1,n37:1},n37:{n36:1,n38:1},n38:{n37:1,n39:1},n39:{n38:1,n40:1},n40:{n39:1,n11:1},n41:{n31:0.5,n42:0.5},n42:{n41:0.5,n43:0.5},n43:{n42:0.5,n44:0.5},n44:{n43:0.5,n45:0.5},n45:{n44:0.5,n46:0.5},n46:{n45:0.5,n47:0.5},n47:{n46:0.5,n48:0.5},n48:{n47:0.5,n49:0.5},n49:{n48:0.5,n50:0.5},n50:{n49:0.5,n51:0.5},n51:{n50:0.5,n52:0.5},n52:{n51:0.5,n53:0.5},n53:{n52:0.5,n54:0.5},n54:{n53:0.5,n55:0.5},n55:{n54:0.5,n56:0.5},n56:{n55:0.5,n57:0.5},n57:{n56:0.5,n58:0.5},n58:{n57:0.5,n59:0.5},n59:{n58:0.5,n1:0.5},n60:{n1:1,n61:1},n61:{n60:1,n62:1},n62:{n61:1,n63:1},n63:{n62:1,n64:1},n64:{n63:1,n65:1},n65:{n64:1,n66:1},n66:{n65:1,n67:1},n67:{n66:1,n68:1},n68:{n67:1,n69:1},n70:{n31:0.5,n71:0.5},n71:{n70:0.5,n72:0.5},n72:{n71:0.5,n73:0.5},n73:{n72:0.5,n74:0.5},n74:{n73:0.5,n75:0.5},n75:{n74:0.5,n76:0.5},n76:{n75:0.5,n77:0.5},n77:{n76:0.5,n78:0.5},n78:{n77:0.5,n79:0.5},n80:{n79:0.5,n81:0.5},n81:{n80:0.5,n82:0.5},n82:{n81:0.5,n83:0.5},n83:{n82:0.5,n84:0.5},n84:{n83:0.5,n85:0.5},n85:{n84:0.5,n86:0.5},n86:{n85:0.5,n87:0.5},n87:{n86:0.5,n88:0.5},n88:{n87:0.5,n89:0.5},n90:{n79:0.5,n91:0.5},n91:{n90:0.5,n92:0.5},n92:{n91:0.5,n93:0.5},n93:{n92:0.5,n94:0.5},n94:{n93:0.5,n95:0.5},n95:{n94:0.5,n96:0.5},n96:{n95:0.5,n97:0.5},n97:{n96:0.5,n98:0.5},n98:{n97:0.5,n99:0.5},n99:{n98:0.5,n100:0.5},n100:{n99:0.5,n101:0.5},n101:{n100:0.5,n102:0.5},n102:{n101:0.5,n103:0.5},n103:{n102:0.5,n104:0.5},n104:{n103:0.5,n105:0.5},n105:{n104:0.5,n106:0.5},n106:{n105:0.5,n107:0.5},n107:{n106:0.5,n108:0.5},n108:{n107:0.5,n109:0.5},n109:{n108:0.5,n1:0.5},n110:{n89:1,n111:1},n111:{n110:1,n112:1},n112:{n111:1,n113:1},n113:{n112:1,n114:1},n114:{n113:1,n115:1},n115:{n114:1,n116:1},n116:{n115:1,n117:1},n117:{n116:1,n118:1},n118:{n117:1,n119:1},n119:{n118:1,n120:1},n120:{n119:1,n121:1},n121:{n120:1,n122:1},n122:{n121:1,n123:1},n123:{n122:1,n124:1},n124:{n123:1,n125:1},n125:{n124:1,n126:1},n126:{n125:1,n127:1},n127:{n126:1,n128:1},n128:{n127:1,n129:1},n129:{n128:1,n1:1},n130:{n89:1,n131:1},n131:{n130:1,n132:1},n132:{n131:1,n133:1},n133:{n132:1,n134:1},n134:{n133:1,n135:1},n135:{n134:1,n136:1},n137:{n136:1,n138:1},n138:{n137:1,n139:1},n139:{n138:1,n140:1},n140:{n139:1,n141:1},n141:{n140:1,n142:1},n142:{n141:1,n143:1},n143:{n142:1,n144:1},n144:{n143:1,n145:1},n145:{n144:1,n146:1},n146:{n145:1,n1:1},n148:{n147:1,n149:1},n149:{n148:1,n150:1},n150:{n149:1,n151:1},n151:{n150:1,n152:1},n152:{n151:1,n153:1},n153:{n152:1,n154:1},n154:{n153:1,n155:1},n155:{n154:1,n156:1},n156:{n155:1,n157:1},n157:{n156:1,n1:1},n158:{n147:1,n159:1},n159:{n158:1,n160:1},n160:{n159:1,n161:1},n161:{n160:1,n162:1},n162:{n161:1,n163:1},n163:{n162:1,n164:1},n164:{n163:1,n165:1},n165:{n164:1,n166:1},n166:{n165:1,n167:1},n167:{n166:1,n11:1},n1:{n2:1,n59:1,n60:1,n109:1,n129:1,n146:1,n157:1},n11:{n10:1,n12:1,n40:1,n167:1},n21:{n20:1,n22:1},n31:{n30:1,n32:1,n41:1,n70:1},n79:{n78:1,n80:1,n90:1},n89:{n88:1,n110:1,n130:1},n136:{n135:1,n137:1},n147:{n148:1,n158:1},n69:{n68:1}};this.nodes={n1:{id:"n1",x:260,y:390},n2:{id:"n2",x:251,y:380},n3:{id:"n3",x:242,y:370},n4:{id:"n4",x:233,y:360},n5:{id:"n5",x:224,y:350},n6:{id:"n6",x:215,y:340},n7:{id:"n7",x:206,y:330},n8:{id:"n8",x:197,y:320},n9:{id:"n9",x:188,y:310},n10:{id:"n10",x:179,y:300},n11:{id:"n11",x:170,y:290},n12:{id:"n12",x:163,y:290},n13:{id:"n13",x:156,y:290},n14:{id:"n14",x:149,y:290},n15:{id:"n15",x:142,y:290},n16:{id:"n16",x:135,y:290},n17:{id:"n17",x:128,y:290},n18:{id:"n18",x:121,y:290},n19:{id:"n19",x:114,y:290},n20:{id:"n20",x:107,y:290},n21:{id:"n21",x:100,y:290},n22:{id:"n22",x:100,y:294},n23:{id:"n23",x:100,y:298},n24:{id:"n24",x:100,y:302},n25:{id:"n25",x:100,y:306},n26:{id:"n26",x:100,y:310},n27:{id:"n27",x:100,y:314},n28:{id:"n28",x:100,y:318},n29:{id:"n29",x:100,y:322},n30:{id:"n30",x:100,y:326},n31:{id:"n31",x:100,y:330},n32:{id:"n32",x:107,y:326},n33:{id:"n33",x:114,y:322},n34:{id:"n34",x:121,y:318},n35:{id:"n35",x:128,y:314},n36:{id:"n36",x:135,y:310},n37:{id:"n37",x:142,y:306},n38:{id:"n38",x:149,y:302},n39:{id:"n39",x:156,y:298},n40:{id:"n40",x:163,y:294},n41:{id:"n41",x:108,y:333},n42:{id:"n42",x:116,y:336},n43:{id:"n43",x:124,y:339},n44:{id:"n44",x:132,y:342},n45:{id:"n45",x:140,y:345},n46:{id:"n46",x:148,y:348},n47:{id:"n47",x:156,y:351},n48:{id:"n48",x:164,y:354},n49:{id:"n49",x:172,y:357},n50:{id:"n50",x:180,y:360},n51:{id:"n51",x:188,y:363},n52:{id:"n52",x:196,y:366},n53:{id:"n53",x:204,y:369},n54:{id:"n54",x:212,y:372},n55:{id:"n55",x:220,y:375},n56:{id:"n56",x:228,y:378},n57:{id:"n57",x:236,y:381},n58:{id:"n58",x:244,y:384},n59:{id:"n59",x:252,y:387},n60:{id:"n60",x:264,y:394},n61:{id:"n61",x:268,y:398},n62:{id:"n62",x:272,y:402},n63:{id:"n63",x:276,y:406},n64:{id:"n64",x:280,y:410},n65:{id:"n65",x:284,y:414},n66:{id:"n66",x:288,y:418},n67:{id:"n67",x:292,y:422},n68:{id:"n68",x:296,y:426},n69:{id:"n69",x:300,y:430},n70:{id:"n70",x:100,y:334},n71:{id:"n71",x:100,y:338},n72:{id:"n72",x:100,y:342},n73:{id:"n73",x:100,y:346},n74:{id:"n74",x:100,y:350},n75:{id:"n75",x:100,y:354},n76:{id:"n76",x:100,y:358},n77:{id:"n77",x:100,y:362},n78:{id:"n78",x:100,y:366},n79:{id:"n79",x:100,y:370},n80:{id:"n80",x:100,y:374},n81:{id:"n81",x:100,y:378},n82:{id:"n82",x:100,y:382},n83:{id:"n83",x:100,y:386},n84:{id:"n84",x:100,y:390},n85:{id:"n85",x:100,y:394},n86:{id:"n86",x:100,y:398},n87:{id:"n87",x:100,y:402},n88:{id:"n88",x:100,y:406},n89:{id:"n89",x:100,y:410},n90:{id:"n90",x:108,y:371},n91:{id:"n91",x:116,y:372},n92:{id:"n92",x:124,y:373},n93:{id:"n93",x:132,y:374},n94:{id:"n94",x:140,y:375},n95:{id:"n95",x:148,y:376},n96:{id:"n96",x:156,y:377},n97:{id:"n97",x:164,y:378},n98:{id:"n98",x:172,y:379},n99:{id:"n99",x:180,y:380},n100:{id:"n100",x:188,y:381},n101:{id:"n101",x:196,y:382},n102:{id:"n102",x:204,y:383},n103:{id:"n103",x:212,y:384},n104:{id:"n104",x:220,y:385},n105:{id:"n105",x:228,y:386},n106:{id:"n106",x:236,y:387},n107:{id:"n107",x:244,y:388},n108:{id:"n108",x:252,y:389},n109:{id:"n109",x:260,y:390},n110:{id:"n110",x:108,y:409},n111:{id:"n111",x:116,y:408},n112:{id:"n112",x:124,y:407},n113:{id:"n113",x:132,y:406},n114:{id:"n114",x:140,y:405},n115:{id:"n115",x:148,y:404},n116:{id:"n116",x:156,y:403},n117:{id:"n117",x:164,y:402},n118:{id:"n118",x:172,y:401},n119:{id:"n119",x:180,y:400},n120:{id:"n120",x:188,y:399},n121:{id:"n121",x:196,y:398},n122:{id:"n122",x:204,y:397},n123:{id:"n123",x:212,y:396},n124:{id:"n124",x:220,y:395},n125:{id:"n125",x:228,y:394},n126:{id:"n126",x:236,y:393},n127:{id:"n127",x:244,y:392},n128:{id:"n128",x:252,y:391},n129:{id:"n129",x:260,y:390},n130:{id:"n130",x:110,y:410},n131:{id:"n131",x:120,y:410},n132:{id:"n132",x:130,y:410},n133:{id:"n133",x:140,y:410},n134:{id:"n134",x:150,y:410},n135:{id:"n135",x:160,y:410},n136:{id:"n136",x:160,y:410},n137:{id:"n137",x:170,y:408},n138:{id:"n138",x:180,y:406},n139:{id:"n139",x:190,y:404},n140:{id:"n140",x:200,y:402},n141:{id:"n141",x:210,y:400},n142:{id:"n142",x:220,y:398},n143:{id:"n143",x:230,y:396},n144:{id:"n144",x:240,y:394},n145:{id:"n145",x:250,y:392},n146:{id:"n146",x:260,y:390},n147:{id:"n147",x:300,y:290},n148:{id:"n148",x:296,y:300},n149:{id:"n149",x:292,y:310},n150:{id:"n150",x:288,y:320},n151:{id:"n151",x:284,y:330},n152:{id:"n152",x:280,y:340},n153:{id:"n153",x:276,y:350},n154:{id:"n154",x:272,y:360},n155:{id:"n155",x:268,y:370},n156:{id:"n156",x:264,y:380},n157:{id:"n157",x:260,y:390},n158:{id:"n158",x:287,y:290},n159:{id:"n159",x:274,y:290},n160:{id:"n160",x:261,y:290},n161:{id:"n161",x:248,y:290},n162:{id:"n162",x:235,y:290},n163:{id:"n163",x:222,y:290},n164:{id:"n164",x:209,y:290},n165:{id:"n165",x:196,y:290},n166:{id:"n166",x:183,y:290},n167:{id:"n167",x:170,y:290}};this.keynodes=["n1","n11","n21","n31","n69","n79","n89","n136","n147"];this.snackManFinalPath=new Array();this.mapGraph={};this.createGraph();this.counter=[this.snackManFinalPath[2],this.snackManFinalPath[3],this.snackManFinalPath[5],this.snackManFinalPath[6]];this.coolerNode=this.snackManFinalPath[4];this.displayNode=this.snackManFinalPath[1];this.boxOfFruitsNode=this.snackManFinalPath[7];this.juiceMachineNode=this.snackManFinalPath[8];if(j.indexOf("counter")==0){this.initialPosition=this.counter[parseInt(j.substring(7))-1]}else{if(j==="cooler"){this.initialPosition=this.coolerNode}else{if(j==="display"){this.initialPosition=this.displayNode}else{this.initialPosition=this.snackManFinalPath[0]}}}this.currentNode=this.initialPosition;this.img=new Sprite({ticksPerFrame:0,numberOfFrames:3,horzSeq:true,x:this.currentNode.x,y:this.currentNode.y-32,width:96,height:32,sourceY:0,img:PreloadImgs.get("$cooker")});this.imgCooker=this.img.image;this.imgCookerPlatter=PreloadImgs.get("$cooker_platter");this.showCooler=false;this.cooler=new Sprite({ticksPerFrame:0,numberOfFrames:4,horzSeq:true,x:288,y:384,width:256,height:64,sourceX:0,sourceY:0,img:PreloadImgs.get("cooler")});this.showDisplay=false;this.display=new Sprite({ticksPerFrame:0,numberOfFrames:4,horzSeq:true,x:160,y:256,width:128,height:32,sourceX:0,sourceY:0,img:PreloadImgs.get("display")});var e=k.evaluate("count(//mission/commands/category[@name='goToBoxOfFruits'])",k,null,XPathResult.ANY_TYPE,null);this.showJuice=e.numberValue>0;if(this.showJuice){this.boxOfFruits=new Sprite({ticksPerFrame:0,numberOfFrames:3,horzSeq:true,x:160,y:416,width:96,height:32,sourceX:0,sourceY:0,img:PreloadImgs.get("boxoffruits")});this.juiceMachine=new Sprite({ticksPerFrame:0,numberOfFrames:4,horzSeq:true,x:320,y:256,width:128,height:32,sourceX:0,sourceY:0,img:PreloadImgs.get("juicemachine")})}this.objective={};this.objective.objectives=[];this.objective.ordered=d.getAttribute("ordered")==="true";this.objective.reward=parseInt(d.getAttribute("reward"));var f=d.getAttribute("maxCommands");this.objective.maxCommands=parseInt((f==null?"0":f));f=d.getAttribute("maxCommandsReward");this.objective.maxCommandsReward=parseInt((f==null?"0":f));this.objective.debug=d.getAttribute("debug")==="true";var c=d.getElementsByTagName("objective");for(var h=0;h<c.length;h++){var g=c[h].childNodes[0].nodeValue;var b=Objective.factory(g);var a=b.init(c[h]);this.objective.objectives.push(a)}this.hasVarQtd=this.createAditionalObjective(d,"varQtd");this.hasCommQtd=this.createAditionalObjective(d,"commQtd");this.lastObjectiveAchieved=-1;this.allObjectivesAchieved=false;this.catched=0;this.delivered=0};SnackMan.prototype.createAditionalObjective=function(b,c){var a=b.getAttribute(c);if(a!=null){var e=Objective.factory(c);var d=e.init(a);this.objective.objectives.push(d);return true}return false};SnackMan.prototype.createGraph=function(){for(var a=0;a<this.keynodes.length;a++){this.snackManFinalPath[a]=this.nodes[this.keynodes[a]]}this.graph=new Graph(this.path)};SnackMan.prototype.reset=function(){this.currentNode=this.initialPosition;this.img.image=this.imgCooker;this.img.x=this.currentNode.x;this.img.y=this.currentNode.y-32;this.img.sourceY=0;this.img.frameIndex=0;this.cooler.sourceX=0;this.cooler.frameIndex=0;this.lastObjectiveAchieved=-1;this.allObjectivesAchieved=false;for(var a=0;a<this.objective.objectives.length;a++){this.objective.objectives[a].achieved=false}};SnackMan.prototype.draw=function(a){if(this.showJuice){this.boxOfFruits.draw(a);this.juiceMachine.draw(a)}this.display.draw(a);this.img.draw(a);this.cooler.draw(a)};SnackMan.prototype.goToBarCounter=function(a){if(a<1||a>4){BlocklyApps.log.push(["fail","Error_doesntExistCounter"]);throw false}this.animateSnackMan(this.counter[a-1])};SnackMan.prototype.goToDisplay=function(){this.animateSnackMan(this.displayNode)};SnackMan.prototype.goToCooler=function(){this.animateSnackMan(this.coolerNode)};SnackMan.prototype.alertRun=function(a){alert(a)};SnackMan.prototype.getCustomer=function(){var b=false;for(var a=0;a<this.counter.length;a++){if(this.currentNode.id===this.counter[a].id){b=true;return(CustomerManager.getCustomerCounter(a+1))}}if(!b){BlocklyApps.log.push(["fail","Error_isntCloseToCustomer"]);throw false}return null};SnackMan.prototype.isThereACustomer=function(){var a=this.getCustomer();BlocklyApps.log.push(["IM",0]);CustomerManager.update();BlocklyApps.log.push(["IM",32]);CustomerManager.update();BlocklyApps.log.push(["IM",0]);CustomerManager.update();return a!=null};SnackMan.prototype.askForDrink=function(){var b=this.getCustomer();if(!b){BlocklyApps.log.push(["fail","Error_thereIsntCustomer"]);throw false}var a=b.askForDrink();if(a==null){BlocklyApps.log.push(["fail","Error_isntThirsty"]);throw false}this.verifyObjectives("askForDrink",b);return a};SnackMan.prototype.catchDrink=function(a){if(this.currentNode.id!=this.coolerNode.id){BlocklyApps.log.push(["fail","Error_isntFrontCooler"]);throw false}if(a.data==null||a.data===undefined||a.data.type!="order"){BlocklyApps.log.push(["fail","Error_doesntHaveOrder"]);throw false}if(a.data.descr.indexOf("coke")==-1){BlocklyApps.log.push(["fail","Error_wrongPlaceForDrink"]);throw false}BlocklyApps.log.push(["OC"]);CustomerManager.update();BlocklyApps.log.push(["OC"]);CustomerManager.update();BlocklyApps.log.push(["OC"]);CustomerManager.update();BlocklyApps.log.push(["CC"]);CustomerManager.update();BlocklyApps.log.push(["CC"]);CustomerManager.update();BlocklyApps.log.push(["CC"]);CustomerManager.update();BlocklyApps.log.push(["IP"]);var b={type:"item",descr:a.data.descr,drinkOrFood:"drink",source:a.data.source,sourceType:a.data.sourceType};this.verifyObjectives("catchDrink",b);this.catched++;return b};SnackMan.prototype.hasThirsty=function(){var a=this.getCustomer();if(!a){BlocklyApps.log.push(["fail","Error_thereIsntCustomer"]);throw false}return a.hasThirsty()};SnackMan.prototype.askForFood=function(){var a=this.getCustomer();if(!a){BlocklyApps.log.push(["fail","Error_thereIsntCustomer"]);throw false}var b=a.askForFood();if(b==null){BlocklyApps.log.push(["fail","Error_isntHunger"]);throw false}this.verifyObjectives("askForFood",a);return b};SnackMan.prototype.hasHunger=function(){var a=this.getCustomer();if(!a){BlocklyApps.log.push(["fail","Error_thereIsntCustomer"]);throw false}return a.hasHunger()};SnackMan.prototype.catchFood=function(a){if(this.currentNode.id!=this.displayNode.id){BlocklyApps.log.push(["fail","Error_isntFrontDisplay"]);throw false}if(a.data==null||a.data===undefined||a.data.type!="order"){BlocklyApps.log.push(["fail","Error_doesntHaveOrder"]);throw false}if(a.data.type!="order"){BlocklyApps.log.push(["fail","Error_doesntOrderFood"]);throw false}if(a.data.descr.indexOf("hotdog")==1){BlocklyApps.log.push(["fail","Error_onlyHotDog"]);throw false}BlocklyApps.log.push(["OD"]);CustomerManager.update();BlocklyApps.log.push(["OD"]);CustomerManager.update();BlocklyApps.log.push(["OD"]);CustomerManager.update();BlocklyApps.log.push(["CD"]);CustomerManager.update();BlocklyApps.log.push(["CD"]);CustomerManager.update();BlocklyApps.log.push(["CD"]);CustomerManager.update();BlocklyApps.log.push(["IP"]);var b={type:"item",descr:a.data.descr,drinkOrFood:"food",source:a.data.source,sourceType:a.data.sourceType};this.verifyObjectives("catchFood",b);this.catched++;return b};SnackMan.prototype.deliver=function(c){if(c.data===undefined||c.data===null||c.data==="undefined"||c.type==="number"){BlocklyApps.log.push(["fail","Error_variableHaventContentToDeliver"]);throw false}var d=this.getCustomer();if(!d){BlocklyApps.log.push(["fail","Error_thereIsntCustomer"]);throw false}var b=d.deliver(c.data);if(b.happy==Customer.DELIVERED_BAD){BlocklyApps.log.push(["fail",b.reason]);throw false}if(b!=null){this.verifyObjectives("deliver",{allCustomers:false,customer:d})}c.data=null;if(b.happy>=Customer.DELIVERED_PARTIAL){this.delivered++}if(b.happy!=Customer.DELIVERED_PARTIAL){for(var a=0;a<11;a++){BlocklyApps.log.push(["IM",0]);CustomerManager.update()}BlocklyApps.log.push(["IO",b,this.catched-this.delivered]);CustomerManager.update()}};SnackMan.prototype.goToBoxOfFruits=function(){this.animateSnackMan(this.boxOfFruitsNode)};SnackMan.prototype.goToJuiceMachine=function(){this.animateSnackMan(this.juiceMachineNode)};SnackMan.prototype.catchFruits=function(a){if(this.currentNode.id!=this.boxOfFruitsNode.id){BlocklyApps.log.push(["fail","Error_isntFrontBoxOfFruits"]);throw false}if(a.data==null||a.data===undefined||a.data.type!="order"){BlocklyApps.log.push(["fail","Error_doesntHaveOrder"]);throw false}if(!(a.data.type==="order"&&a.data.descr.indexOf("$$juiceof")==0)){BlocklyApps.log.push(["fail","Error_onlyFruits"]);throw false}BlocklyApps.log.push(["SF"]);CustomerManager.update();BlocklyApps.log.push(["SF"]);CustomerManager.update();BlocklyApps.log.push(["HF"]);CustomerManager.update();BlocklyApps.log.push(["HF"]);CustomerManager.update();BlocklyApps.log.push(["IP"]);var b={type:"item",descr:"$$"+a.data.descr.substring(9),drinkOrFood:"drink",source:a.data.source,sourceType:a.data.sourceType};return b};SnackMan.prototype.prepareAndCatchJuice=function(a){if(this.currentNode.id!=this.juiceMachineNode.id){BlocklyApps.log.push(["fail","Error_isntFrontJuiceMachine"]);throw false}if(a.data==null||a.data===undefined||a.data.type!="item"){BlocklyApps.log.push(["fail","Error_doesntHaveItem"]);throw false}if(a.data.descr!="$$orange"){BlocklyApps.log.push(["fail","Error_onlyPutFruits"]);throw false}BlocklyApps.log.push(["MJ"]);CustomerManager.update();BlocklyApps.log.push(["MJ"]);CustomerManager.update();BlocklyApps.log.push(["MJ"]);CustomerManager.update();BlocklyApps.log.push(["HJ"]);CustomerManager.update();BlocklyApps.log.push(["HJ"]);CustomerManager.update();BlocklyApps.log.push(["HJ"]);CustomerManager.update();BlocklyApps.log.push(["IP"]);var b={type:"item",descr:"$$juiceof"+a.data.descr.substring(2),drinkOrFood:"drink",source:a.data.source,sourceType:a.data.sourceType};this.catched++;return b};SnackMan.prototype.animateSnackMan=function(b){var a=this.graph.findShortestPath(this.currentNode.id,b.id);for(var c=0;c<a.length;c++){var d=this.nodes[a[c]];BlocklyApps.log.push(["MS",this.currentNode.x,this.currentNode.y,d.x,d.y]);this.currentNode=d;CustomerManager.update()}BlocklyApps.log.push(["CO",0])};SnackMan.prototype.changeSnackManImage=function(a){this.img.sourceY=a;this.img.update();Game.display()};SnackMan.prototype.changeSnackManPosition=function(c,b,a,d){if(a<c){this.img.sourceY=32}else{if(a>c){this.img.sourceY=64}else{if(d<b){this.img.sourceY=96}else{this.img.sourceY=0}}}this.img.update();this.img.x=a;this.img.y=d-32;Game.display()};SnackMan.prototype.nextOpenCoolerImage=function(){if(this.cooler.invert==true){this.cooler.invertDirection()}this.updateCoolerImage()};SnackMan.prototype.nextCloseCoolerImage=function(){if(this.cooler.invert==false){this.cooler.invertDirection()}this.updateCoolerImage()};SnackMan.prototype.updateCoolerImage=function(){this.cooler.update();this.showCooler=true;Game.display();this.showCooler=false};SnackMan.prototype.nextShowFruitImage=function(){if(this.boxOfFruits.invert==true){this.boxOfFruits.invertDirection()}this.updateBoxOfFruitsImage()};SnackMan.prototype.nextHideFruitImage=function(){if(this.boxOfFruits.invert==false){this.boxOfFruits.invertDirection()}this.updateBoxOfFruitsImage()};SnackMan.prototype.updateBoxOfFruitsImage=function(){this.boxOfFruits.update();Game.display()};SnackMan.prototype.nextShowJuiceMachineImage=function(){if(this.juiceMachine.invert==true){this.juiceMachine.invertDirection()}this.updateJuiceMachineImage()};SnackMan.prototype.nextHideJuiceMachineImage=function(){if(this.juiceMachine.invert==false){this.juiceMachine.invertDirection()}this.updateJuiceMachineImage()};SnackMan.prototype.updateJuiceMachineImage=function(){this.juiceMachine.update();Game.display()};SnackMan.prototype.nextOpenDisplayImage=function(){if(this.display.invert==true){this.display.invertDirection()}this.updateDisplayImage()};SnackMan.prototype.nextCloseDisplayImage=function(){if(this.display.invert==false){this.display.invertDirection()}this.updateDisplayImage()};SnackMan.prototype.updateDisplayImage=function(){this.display.update();this.showDisplay=true;Game.display();this.showDisplay=false};SnackMan.prototype.changeImagePlatter=function(){this.img.image=this.imgCookerPlatter;Game.display()};SnackMan.prototype.changeImageOriginal=function(){this.img.image=this.imgCooker;Game.display()};SnackMan.prototype.checkObjectives=function(){this.verifyObjectives("counter",{nx:this.img.x,ny:this.img.y+32})};SnackMan.prototype.verifyObjectives=function(b,a){if(!Objective.verifyObjectives(b,a)){return}$.growl({title:BlocklyApps.getMsg("NoBugs_goalAchieved"),message:BlocklyApps.getMsg("NoBugs_achieved")+" "+(this.lastObjectiveAchieved+1)+" "+BlocklyApps.getMsg("NoBugs_of")+" "+this.objective.objectives.length});Game.alertGoalButton()};SnackMan.prototype.addReward=function(e,j,g,h){var f={total:0,base:0,bonus:[]};if(this.allObjectivesAchieved){f.total=this.objective.reward;f.base=f.total;if(e<=this.objective.maxCommands){f.total+=this.objective.maxCommandsReward;f.bonus.push({name:"Victory_MaxCommands",value:this.objective.maxCommandsReward,extraInfo:null})}if(g!=null&&j<=g){h=h.split(" ");var c=Math.floor(g/h.length);var a=0;for(var d=1;d<=h.length;d++){if(j<=c*d){a=parseInt(h[d-1]);break}}if(a>0){var b=Math.trunc((j/60));var k=j-(b*60);f.bonus.push({name:"Victory_TimeBonus",value:a,extraInfo:(b>0?b+"'":"")+k+'"'});f.total+=a}}}return f};"use strict";var CustOpt={};CustOpt.path={n2:{n1:1,n3:1},n3:{n2:1,n4:1},n4:{n3:1,n5:1},n5:{n4:1,n6:1},n6:{n5:1,n7:1},n7:{n6:1,n8:1},n8:{n7:1,n9:1},n9:{n8:1,n10:1},n10:{n9:1,n11:1},n11:{n10:1,n12:1},n12:{n11:1,n13:1},n13:{n12:1,n14:1},n14:{n13:1,n15:1},n15:{n14:1,n16:1},n16:{n15:1,n17:1},n17:{n16:1,n18:1},n18:{n17:1,n19:1},n19:{n18:1,n20:1},n20:{n19:1,n21:1},n21:{n20:1,n22:1},n22:{n21:1,n23:1},n23:{n22:1,n24:1},n24:{n23:1,n25:1},n25:{n24:1,n26:1},n26:{n25:1,n27:1},n27:{n26:1,n28:1},n28:{n27:1,n29:1},n29:{n28:1,n30:1},n30:{n29:1,n31:1},n31:{n30:1,n32:1},n32:{n31:1,n33:1},n34:{n33:1,n35:1},n35:{n34:1,n36:1},n36:{n35:1,n37:1},n37:{n36:1,n38:1},n38:{n37:1,n39:1},n39:{n38:1,n40:1},n40:{n39:1,n41:1},n41:{n40:1,n42:1},n42:{n41:1,n43:1},n33:{n32:1,n34:1,n44:1},n44:{n33:1,n45:1},n45:{n44:1,n46:1},n46:{n45:1,n47:1},n47:{n46:1,n48:1},n48:{n47:1,n49:1},n49:{n48:1,n50:1},n50:{n49:1,n51:1},n51:{n50:1,n52:1},n52:{n51:1,n53:1},n54:{n53:1,n55:1},n55:{n54:1,n56:1},n56:{n55:1,n57:1},n57:{n56:1,n58:1},n58:{n57:1,n59:1},n59:{n58:1,n60:1},n60:{n59:1,n61:1},n61:{n60:1,n62:1},n62:{n61:1,n63:1},n53:{n52:1,n54:1,n64:1},n64:{n53:1,n65:1},n65:{n64:1,n66:1},n66:{n65:1,n67:1},n67:{n66:1,n68:1},n68:{n67:1,n69:1},n69:{n68:1,n70:1},n70:{n69:1,n71:1},n71:{n70:1,n72:1},n72:{n71:1,n73:1},n74:{n73:1,n75:1},n75:{n74:1,n76:1},n76:{n75:1,n77:1},n77:{n76:1,n78:1},n78:{n77:1,n79:1},n79:{n78:1,n80:1},n80:{n79:1,n81:1},n81:{n80:1,n82:1},n82:{n81:1,n83:1},n73:{n72:1,n74:1,n84:1},n84:{n73:1,n85:1},n85:{n84:1,n86:1},n86:{n85:1,n87:1},n87:{n86:1,n88:1},n88:{n87:1,n89:1},n89:{n88:1,n90:1},n90:{n89:1,n91:1},n91:{n90:1,n92:1},n92:{n91:1,n93:1},n94:{n93:1,n95:1},n95:{n94:1,n96:1},n96:{n95:1,n97:1},n97:{n96:1,n98:1},n98:{n97:1,n99:1},n99:{n98:1,n100:1},n100:{n99:1,n101:1},n101:{n100:1,n102:1},n102:{n101:1,n103:1},n93:{n92:1,n94:1},n1:{n2:1},n43:{n42:1},n63:{n62:1},n83:{n82:1},n103:{n102:1}};CustOpt.nodes={n1:{id:"n1",x:14,y:96},n2:{id:"n2",x:14,y:102},n3:{id:"n3",x:14,y:108},n4:{id:"n4",x:14,y:114},n5:{id:"n5",x:14,y:120},n6:{id:"n6",x:14,y:126},n7:{id:"n7",x:14,y:132},n8:{id:"n8",x:14,y:138},n9:{id:"n9",x:14,y:144},n10:{id:"n10",x:14,y:150},n11:{id:"n11",x:14,y:156},n12:{id:"n12",x:14,y:162},n13:{id:"n13",x:14,y:168},n14:{id:"n14",x:14,y:174},n15:{id:"n15",x:14,y:180},n16:{id:"n16",x:14,y:186},n17:{id:"n17",x:14,y:192},n18:{id:"n18",x:14,y:198},n19:{id:"n19",x:14,y:204},n20:{id:"n20",x:14,y:210},n21:{id:"n21",x:14,y:216},n22:{id:"n22",x:14,y:222},n23:{id:"n23",x:14,y:228},n24:{id:"n24",x:14,y:234},n25:{id:"n25",x:14,y:240},n26:{id:"n26",x:14,y:246},n27:{id:"n27",x:14,y:252},n28:{id:"n28",x:14,y:258},n29:{id:"n29",x:14,y:264},n30:{id:"n30",x:14,y:270},n31:{id:"n31",x:14,y:276},n32:{id:"n32",x:14,y:282},n33:{id:"n33",x:14,y:288},n34:{id:"n34",x:17,y:290},n35:{id:"n35",x:20,y:290},n36:{id:"n36",x:23,y:290},n37:{id:"n37",x:26,y:290},n38:{id:"n38",x:29,y:290},n39:{id:"n39",x:32,y:290},n40:{id:"n40",x:35,y:290},n41:{id:"n41",x:38,y:290},n42:{id:"n42",x:41,y:290},n43:{id:"n43",x:44,y:290},n44:{id:"n44",x:14,y:294},n45:{id:"n45",x:14,y:298},n46:{id:"n46",x:14,y:302},n47:{id:"n47",x:14,y:306},n48:{id:"n48",x:14,y:310},n49:{id:"n49",x:14,y:314},n50:{id:"n50",x:14,y:318},n51:{id:"n51",x:14,y:322},n52:{id:"n52",x:14,y:326},n53:{id:"n53",x:14,y:330},n54:{id:"n54",x:17,y:330},n55:{id:"n55",x:20,y:330},n56:{id:"n56",x:23,y:330},n57:{id:"n57",x:26,y:330},n58:{id:"n58",x:29,y:330},n59:{id:"n59",x:32,y:330},n60:{id:"n60",x:35,y:330},n61:{id:"n61",x:38,y:330},n62:{id:"n62",x:41,y:330},n63:{id:"n63",x:44,y:330},n64:{id:"n64",x:14,y:334},n65:{id:"n65",x:14,y:338},n66:{id:"n66",x:14,y:342},n67:{id:"n67",x:14,y:346},n68:{id:"n68",x:14,y:350},n69:{id:"n69",x:14,y:354},n70:{id:"n70",x:14,y:358},n71:{id:"n71",x:14,y:362},n72:{id:"n72",x:14,y:366},n73:{id:"n73",x:14,y:370},n74:{id:"n74",x:17,y:370},n75:{id:"n75",x:20,y:370},n76:{id:"n76",x:23,y:370},n77:{id:"n77",x:26,y:370},n78:{id:"n78",x:29,y:370},n79:{id:"n79",x:32,y:370},n80:{id:"n80",x:35,y:370},n81:{id:"n81",x:38,y:370},n82:{id:"n82",x:41,y:370},n83:{id:"n83",x:44,y:370},n84:{id:"n84",x:14,y:374},n85:{id:"n85",x:14,y:378},n86:{id:"n86",x:14,y:382},n87:{id:"n87",x:14,y:386},n88:{id:"n88",x:14,y:390},n89:{id:"n89",x:14,y:394},n90:{id:"n90",x:14,y:398},n91:{id:"n91",x:14,y:402},n92:{id:"n92",x:14,y:406},n93:{id:"n93",x:14,y:410},n94:{id:"n94",x:17,y:410},n95:{id:"n95",x:20,y:410},n96:{id:"n96",x:23,y:410},n97:{id:"n97",x:26,y:410},n98:{id:"n98",x:29,y:410},n99:{id:"n99",x:32,y:410},n100:{id:"n100",x:35,y:410},n101:{id:"n101",x:38,y:410},n102:{id:"n102",x:41,y:410},n103:{id:"n103",x:44,y:410}};CustOpt.keynodes=["n1","n43","n63","n83","n103"];CustOpt.counter=["n43","n63","n83","n103"];CustOpt.door="n1";CustOpt.customerFinalPath=new Array();PreloadImgs.put("$customer01","images/$customer01.png");PreloadImgs.put("$customer01_anger","images/$customer01_anger.png");PreloadImgs.put("$customer02","images/$customer02.png");PreloadImgs.put("$customer02_anger","images/$customer02_anger.png");PreloadImgs.put("$customer03","images/$customer03.png");PreloadImgs.put("$customer03_anger","images/$customer03_anger.png");PreloadImgs.put("$customer04","images/$customer04.png");PreloadImgs.put("$customer04_anger","images/$customer04_anger.png");PreloadImgs.put("coin","images/coin.png");PreloadImgs.put("anger","images/anger.png");CustOpt.createCustomerPath=function(){for(var a=0;a<CustOpt.keynodes.length;a++){CustOpt.customerFinalPath[a]=CustOpt.nodes[CustOpt.keynodes[a]]}CustOpt.graph=new Graph(CustOpt.path)};CustOpt.createCustomerPath();var Customer={};Customer=function(a){this.drinks=a.drinks;this.dUnfulfilled=0;this.foods=a.foods;this.fUnfulfilled=0;this.currentNode=CustOpt.nodes[a.init];this.dest=CustOpt.nodes[a.place.id];this.place=a.place.id;this.placeType=a.place.type;this.state=(this.currentNode.id===CustOpt.customerFinalPath[0].id?0:8);this.showCustomer=this.state!==0;this.showDoor=!this.showCustomer;this.log=[];this.img=new Sprite({ticksPerFrame:0,numberOfFrames:3,horzSeq:true,x:this.currentNode.x,y:this.currentNode.y-32,width:96,height:32,sourceY:0,img:PreloadImgs.get("$customer"+a.id)});if(this.state===8){this.img.update()}this.imgCustAnger=PreloadImgs.get("$customer"+a.id+"_anger");this.door=new Sprite({ticksPerFrame:0,numberOfFrames:4,horzSeq:false,x:0,y:32,width:64,height:256,img:PreloadImgs.get("doors")});this.coin=new Sprite({ticksPerFrame:0,numberOfFrames:10,horzSeq:true,width:440,height:40,sourceY:0,img:PreloadImgs.get("coin")});this.showCoin=false;this.fire=new Sprite({ticksPerFrame:0,numberOfFrames:10,horzSeq:true,width:160,height:32,sourceY:0,img:PreloadImgs.get("anger")});this.showFire=false};Customer.prototype.update=function(){switch(this.state){case 0:case 1:case 2:case 3:this.log.push(["UD"]);break;case 4:this.log.push(["SC",true]);break;case 5:this.log.push(["SD",false]);this.path=CustOpt.graph.findShortestPath(this.currentNode.id,this.dest.id);break;case 6:var a=this.path.shift();if(a){a=CustOpt.nodes[a];this.log.push(["MC",this.currentNode.x,this.currentNode.y,a.x,a.y]);this.currentNode=a;return}break;case 7:this.log.push(["MC",this.currentNode.x,this.currentNode.y,this.currentNode.x,this.currentNode.y]);break;case 8:return;case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:this.log.push(["UC",true]);break;case 20:this.log.push(["UC",false]);this.state=8;return;case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:this.log.push(["UF",true]);break;case 31:this.log.push(["UF",false]);this.state=8;return}this.state++};Customer.prototype.animate=function(){var a=this.log.shift();if(a){var b=a.shift();switch(b){case"MC":this.changeCustomerPosition(a);break;case"SC":this.showCustomer=a.shift();break;case"SD":this.showDoor=a.shift();break;case"UD":this.door.update();break;case"UC":this.showCoin=a.shift();this.coin.update();break;case"UF":this.showFire=a.shift();this.fire.update();break}}};Customer.prototype.changeCustomerPosition=function(a){if(a[2]<a[0]){this.img.sourceY=32}else{if(a[2]>a[0]){this.img.sourceY=64}else{if(a[3]<a[1]){this.img.sourceY=128}else{this.img.sourceY=0}}}this.img.update();this.img.x=a[2];this.img.y=a[3]-32};Customer.prototype.draw=function(a){if(this.showDoor){this.door.draw(a)}if(this.showCustomer){if(this.showFire){a.drawImage(this.imgCustAnger,this.img.x,this.img.y)}else{this.img.draw(a)}}if(this.showCoin){this.coin.draw(a,22,20)}else{if(this.showFire){this.fire.draw(a)}}};Customer.prototype.askForDrink=function(){if(this.dUnfulfilled>=this.drinks.length){return null}var a=this.drinks[this.dUnfulfilled];return{type:"order",descr:"$$"+a.item,drinkOrFood:"drink",source:this.currentNode.id,sourceType:this.placeType}};Customer.prototype.hasThirsty=function(){return(this.dUnfulfilled<this.drinks.length)};Customer.prototype.askForFood=function(){if(this.fUnfulfilled>=this.foods.length){return null}var a=this.foods[this.fUnfulfilled];return{type:"order",descr:"$$"+a.item,drinkOrFood:"food",source:this.currentNode.id,sourceType:this.placeType}};Customer.prototype.hasHunger=function(){return(this.fUnfulfilled<this.foods.length)};Customer.DELIVERED_BAD=0;Customer.DELIVERED_PARTIAL=1;Customer.DELIVERED_TOTAL=2;Customer.prototype.deliver=function(b){var a=0;var f=Customer.DELIVERED_BAD;var c=null;if((b.type==="item")&&((b.drinkOrFood==="drink"&&(this.dUnfulfilled<this.drinks.length))||(b.drinkOrFood==="food"&&(this.fUnfulfilled<this.foods.length)))){if(b.source===this.currentNode.id){var e=(b.drinkOrFood==="drink"?this.drinks[this.dUnfulfilled]:this.foods[this.fUnfulfilled]);if(b.descr==="$$"+e.item){if(b.drinkOrFood==="drink"){this.dUnfulfilled++}else{this.fUnfulfilled++}a=e.price;f=((this.dUnfulfilled==this.drinks.length)&&(this.fUnfulfilled==this.foods.length)?Customer.DELIVERED_TOTAL:Customer.DELIVERED_PARTIAL)}}else{c="Error_doesntMatchPosition"}}else{c="Error_deliveredWrongRequest"}if(f===Customer.DELIVERED_TOTAL){this.showCoin=true;this.coin.x=this.img.x+5;this.coin.y=this.img.y-20;this.state=9}else{if(f==Customer.DELIVERED_BAD){this.showFire=true;this.fire.x=this.img.x+8;this.fire.y=this.img.y-32;this.state=21}}return{money:a,happy:f,reason:c}};"use strict";var CustomerManager={};var customers=[];PreloadImgs.put("banco","images/banco.png");CustomerManager.init=function(a,b){this.banco=PreloadImgs.get("banco");this.optCustomers=a;this.randomization=[];if(b!=undefined){this.parseSN(b)}};CustomerManager.parseSN=function(e){var a=e.getElementsByTagName("randomization");for(var b=0;b<a.length;b++){var d=a[b];var c={};c.qtd=d.getAttribute("qtd");c.type=d.textContent.toString();c.set=d.getAttribute("set");if(c.set==null){c.set="new"}this.randomization[b]=c}};CustomerManager.reset=function(){customers=[];var d=this.optCustomers.firstElementChild;while(d!=null){var e=d.getElementsByTagName("init")[0].textContent.toString();if(e==="door"){e=CustOpt.door}else{if(e.indexOf("counter")==0){e=CustOpt.counter[parseInt(e.substring(7))-1]}}var a=d.getElementsByTagName("dest")[0];if(a!=null){a=a.textContent.toString();if(a.indexOf("counter")==0){a={id:CustOpt.counter[parseInt(a.substring(7))-1],type:"counter"}}}var f=d.getElementsByTagName("id")[0].textContent.toString();var c=CustomerManager.extractItems("food",d.getElementsByTagName("foods")[0]);var b=CustomerManager.extractItems("drink",d.getElementsByTagName("drinks")[0],d.getAttribute("randomType"),c.length);customers.push(new Customer({init:e,place:a,id:f,foods:c,drinks:b}));d=d.nextElementSibling}this.transformSN()};CustomerManager.transformSN=function(){if(this.randomization.length>0){var c=null;for(var a=0;a<this.randomization.length;a++){switch(this.randomization[a].set){case"new":c=this.selectCustomers(customers.length-this.randomization[a].qtd,[]);break;case"notTheSame":c=this.selectCustomers(customers.length-this.randomization[a].qtd,c);break}switch(this.randomization[a].type){case"thirsty":for(var b=0;b<c.length;b++){customers[c[b]].drinks=[]}break;case"hungry":for(var b=0;b<c.length;b++){customers[c[b]].foods=[]}break}}}};CustomerManager.selectCustomers=function(d,f){var g=[];var b=0;for(var c=0;c<customers.length;c++){if(f.indexOf(c)==-1){g[b]=c;b++}}var a=[];for(var c=0;c<d;c++){var e=Math.floor((Math.random()*(g.length)));a[c]=g[e];g.splice(e,1)}return a};CustomerManager.extractItems=function(m,i,a,p){var g=i.getAttribute("randomMin");var c=i.getElementsByTagName(m);var e=[];for(var f=0;f<c.length;f++){e[f]=f}if(g!=null){g=parseInt(g);var n=parseInt(i.getAttribute("randomMax"));var h=Math.floor((Math.random()*((n-g)+1)))+g;if(p==0&&h==0&&a==="atLeastOne"){h=1}while(e.length>h){var q=Math.floor((Math.random()*(e.length)));e.splice(q,1)}}var k=[];for(var f=0;f<e.length;f++){var o=c[e[f]];var d=o.childNodes[0].nodeValue;var b=o.getAttribute("qt");var l=o.getAttribute("price");k.push({item:d,qt:b,price:l})}return k};CustomerManager.update=function(){for(var a=0;a<customers.length;a++){customers[a].update()}};CustomerManager.animation=function(){for(var a=0;a<customers.length;a++){customers[a].animate()}};CustomerManager.draw=function(b){var e=[true,true,true,true];for(var d=0;d<customers.length;d++){customers[d].draw(b);var a=customers[d].currentNode.id;for(var c=0;c<CustOpt.counter.length;c++){if(a===CustOpt.counter[c]){e[c]=false;break}}}CustomerManager.drawCounters(b,e)};CustomerManager.drawCounters=function(a,c){for(var b=0;b<c.length;b++){if(c[b]){var d=CustOpt.nodes[CustOpt.counter[b]];a.drawImage(this.banco,d.x,d.y-32)}}};CustomerManager.getCustomerCounter=function(b){b=b-1;for(var a=0;a<customers.length;a++){if(customers[a].currentNode.id===CustOpt.counter[b]){return customers[a]}}return null};CustomerManager.getCustomerPosition=function(b){for(var a=0;a<CustOpt.counter.length;a++){if(b===CustOpt.counter[a]){return a+1+" "}}return"0"};"use strict";var Sprite={};Sprite=function(a){this.frameIndex=0;this.tickCount=0;if(a.ticksPerFrame===undefined){this.ticksPerFrame=1}else{this.ticksPerFrame=a.ticksPerFrame}this.numberOfFrames=a.numberOfFrames||1;this.horzSeq=a.horzSeq;this.x=a.x;this.y=a.y;this.sourceX=a.sourceX||0;this.sourceY=a.sourceY||0;this.width=a.width;this.height=a.height;if(a.img){this.image=a.img}else{this.image=new Image();this.image.src=a.imgSrc}this.invert=false};Sprite.prototype.update=function(){this.tickCount+=1;if(this.tickCount>this.ticksPerFrame){this.tickCount=1;if((!this.invert&&this.frameIndex<this.numberOfFrames-1)||(this.invert&&this.frameIndex>0)){if(this.invert){this.frameIndex-=1}else{this.frameIndex+=1}}else{if(this.invert){this.frameIndex=this.numberOfFrames-1}else{this.frameIndex=0}}}};Sprite.prototype.invertDirection=function(){this.invert=!this.invert;this.tickCount=0;this.frameIndex=(this.invert?this.numberOfFrames-1:0)};Sprite.prototype.draw=function(i,a,e){var d=this.numberOfFrames;var b=this.frameIndex;var g,f,h,c;if(this.horzSeq){g=b*this.width/d;f=this.sourceY;h=this.width/d;c=this.height;if(a===undefined){a=this.width/d;e=this.height}}else{g=this.sourceX;f=b*this.height/d;h=this.width;c=this.height/d;if(a===undefined){a=this.width;e=this.height/d}}i.drawImage(this.image,g,f,h,c,this.x,this.y,a,e)};"use strict";NoBugsInterpreter.prototype=new Interpreter;NoBugsInterpreter.prototype.constructor=NoBugsInterpreter;NoBugsInterpreter.prototype.parent=Interpreter.prototype;function NoBugsInterpreter(b,a){this.creatingScope=false;this.variables=[];this.base=Interpreter;this.base(b,a)}NoBugsInterpreter.prototype.populateScope_=function(b,a){this.creatingScope=true;this.parent.populateScope_.call(this,b,a);this.creatingScope=false};NoBugsInterpreter.prototype.setProperty=function(e,b,d,a,c){this.parent.setProperty.call(this,e,b,d,a,c);if(this.creatingScope){this.scope=e;this.variables.push({scope:e,name:b})}};var NoBugsJavaScript={};NoBugsJavaScript.oldVarSet=null;NoBugsJavaScript.oldLogicCompare=null;NoBugsJavaScript.varName=null;NoBugsJavaScript.typeComparison="function nobugsComparison(arg0, arg1, operator) {if (arg0.type != undefined ) {arg0 = arg0.descr; } else if (arg1.type != undefined) {arg1 = arg1.descr;}var OPERATORS={'EQ': '==','NEQ': '!=','LT': '<','LTE': '<=','GT': '>','GTE': '>='};return eval(arg0 + ' ' + OPERATORS[operator] + ' ' + arg1);};";NoBugsJavaScript.redefine=function(){Blockly.Msg.CONTROLS_IF_MSG_THEN=BlocklyApps.getMsg("Blockly_ifThen");if(NoBugsJavaScript.oldVarSet==null){NoBugsJavaScript.oldVarSet=Blockly.JavaScript.variables_set;Blockly.JavaScript.variables_set=NoBugsJavaScript.newVarSet}if(NoBugsJavaScript.oldLogicCompare==null){NoBugsJavaScript.oldLogicCompare=Blockly.JavaScript.logic_compare;Blockly.JavaScript.logic_compare=NoBugsJavaScript.newLogicCompare}};NoBugsJavaScript.newVarSet=function(b){var a=NoBugsJavaScript.oldVarSet(b);return'NoBugsJavaScript.varName="'+b.getFieldValue("VAR")+'";\n'+a+"\nNoBugsJavaScript.varName=null;\n"};NoBugsJavaScript.OPERATORS={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="};NoBugsJavaScript.newLogicCompare=function(f){var g=f.getFieldValue("OP");var b=NoBugsJavaScript.OPERATORS[g];var a=(b=="=="||b=="!=")?Blockly.JavaScript.ORDER_EQUALITY:Blockly.JavaScript.ORDER_RELATIONAL;var e=Blockly.JavaScript.valueToCode(f,"A",a)||"0";var d=Blockly.JavaScript.valueToCode(f,"B",a)||"0";var c='nobugsComparison({0}, {1}, "{2}")'.format(e,d,g);return[c,a]};function nobugsComparison(arg0,arg1,operator){arg0=arg0.data;arg1=arg1.data;operator=NoBugsJavaScript.OPERATORS[operator.data];if(arg0.type!=undefined){arg0='"'+arg0.descr+'"'}else{if(arg1.type!=undefined){arg1='"'+arg1.descr+'"'}}var ret=eval(arg0+" "+operator+" "+arg1);return ret};function loadMission(c){var a=new window.XMLHttpRequest();a.open("GET",c,false);a.setRequestHeader("Content-Type","text/xml");a.send("");var b=a.responseXML;return b}function transformStrToXml(a){if(window.DOMParser){return(new window.DOMParser()).parseFromString(a,"text/xml")}else{if(typeof window.ActiveXObject!="undefined"&&new window.ActiveXObject("Microsoft.XMLDOM")){var b=new window.ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(xmlStr);return b}else{return null}}};function findVariable(){var c=Game.jsInterpreter.variables;var a=c[0].scope.properties.NoBugsJavaScript.properties.varName.data;for(var b=1;b<c.length;b++){if(c[b].name===a){return c[b].scope.properties[a].data}}return null}var Objective={factories:[]};Objective.init=function(b,a){return{objective:b.childNodes[0].nodeValue,achieved:false,trata:a}};Objective.verifyObjectives=function(e,c){if((hero.allObjectivesAchieved||(hero.objective.debug&&Game.runningStatus!=2))){return false}var b=Objective.factory(e);var a=false;if(hero.objective.ordered){if(!hero.objective.objectives[hero.lastObjectiveAchieved+1].objective===e){return false}if(b.checkObjective(c,hero.objective.objectives[hero.lastObjectiveAchieved+1])){Objective.markAchieved(hero.objective.objectives[hero.lastObjectiveAchieved+1]);return true}}else{for(var d=0;d<hero.objective.objectives.length;d++){if(hero.objective.objectives[d].objective===e&&!hero.objective.objectives[d].achieved){if(b.checkObjective(c,hero.objective.objectives[d])){Objective.markAchieved(hero.objective.objectives[d]);if(e==="deliver"&&c.allCustomers){a=true}else{return true}}}}}return a};Objective.markAchieved=function(a){a.achieved=true;hero.lastObjectiveAchieved++;hero.allObjectivesAchieved=(hero.lastObjectiveAchieved+1)==hero.objective.objectives.length};Objective.factory=function(a){var b=this.factories[a];if(b!=undefined){return b}switch(a){case"counter":this.factories[a]=new Objective.Counter();break;case"askForFood":this.factories[a]=new Objective.AskForFood();break;case"catchFood":this.factories[a]=new Objective.CatchFood();break;case"askForDrink":this.factories[a]=new Objective.AskForDrink();break;case"catchDrink":this.factories[a]=new Objective.CatchDrink();break;case"deliver":this.factories[a]=new Objective.Deliver();break;case"varQtd":this.factories[a]=new Objective.VarQtd();break;case"commQtd":this.factories[a]=new Objective.CommsQtd();break}return this.factories[a]};Objective.createExplanationItemPlacePos=function(d,b){var a=BlocklyApps.getMsg("_"+b.place);var c=BlocklyApps.getMsg(d);return c.format(a+" "+b.pos)};Objective.Counter=function(){};Objective.Counter.prototype.init=function(a){var b=Objective.init(a,this);b.pos=a.getAttribute("pos");return b};Objective.Counter.prototype.checkObjective=function(a,b){var c=hero.counter[b.pos-1];if(a.nx==c.x&&a.ny==c.y){return true}return false};Objective.Counter.prototype.createExplanationItem=function(a){var b=BlocklyApps.getMsg("explanation_counter");return b.format(a.pos)};Objective.AskForFood=function(){};Objective.AskForFood.prototype.init=function(a){var b=Objective.init(a,this);b.pos=a.getAttribute("pos");b.place=a.getAttribute("place");b.distinct=a.getAttribute("distinct")==="true";return b};Objective.AskForFood.prototype.checkObjective=function(c,b){if(b.distinct){var a=findVariable();if(a!=undefined){return false}}if(b.place==="counter"){if(c.currentNode.id===CustOpt.counter[b.pos-1]){return true}}return false};Objective.AskForFood.prototype.createExplanationItem=function(a){if(a.distinct){return Objective.createExplanationItemPlacePos("explanation_askForFoodDistinctVar",a)}return Objective.createExplanationItemPlacePos("explanation_askForFood",a)};Objective.CatchSomething=function(a){this.key=a};Objective.CatchSomething.prototype.init=function(a){var b=Objective.init(a,this);b.pos=a.getAttribute("pos");b.place=a.getAttribute("place");return b};Objective.CatchSomething.prototype.checkObjective=function(c,b){var d=null;if(b.place==="counter"){d=CustomerManager.getCustomerCounter(b.pos)}if(d==null){return false}var a=this.askSomething(d);return c.descr===a.descr};Objective.CatchSomething.prototype.createExplanationItem=function(a){return Objective.createExplanationItemPlacePos(this.key,a)};Objective.CatchSomething.prototype.askSomething=function(a){return{descr:"nothing"}};Objective.CatchFood=function(){Objective.CatchSomething.call(this,"explanation_catchFood")};inherits(Objective.CatchSomething,Objective.CatchFood);Objective.CatchFood.prototype.askSomething=function(a){return a.askForFood()};Objective.CatchDrink=function(){Objective.CatchSomething.call(this,"explanation_catchDrink")};inherits(Objective.CatchSomething,Objective.CatchDrink);Objective.CatchDrink.prototype.askSomething=function(a){return a.askForDrink()};Objective.AskForDrink=function(){Objective.AskForFood.call(this)};inherits(Objective.AskForFood,Objective.AskForDrink);Objective.AskForDrink.prototype.createExplanationItem=function(a){return Objective.createExplanationItemPlacePos("explanation_askForDrink",a)};Objective.Deliver=function(){};Objective.Deliver.prototype.init=function(a){var b=Objective.init(a,this);b.pos=a.getAttribute("pos");b.place=a.getAttribute("place");return b};Objective.Deliver.prototype.checkObjective=function(a,b){var c=null;if(b.place==="counter"){if(a.allCustomers){c=CustomerManager.getCustomerCounter(b.pos)}else{if(a.customer.currentNode.id===CustOpt.counter[b.pos-1]){c=a.customer}}}if(c==null){return false}return !(c.hasThirsty()||c.hasHunger())};Objective.Deliver.prototype.createExplanationItem=function(a){return Objective.createExplanationItemPlacePos("explanation_deliver",a)};Objective.VarQtd=function(){};Objective.VarQtd.prototype.init=function(b){var a={objective:"varQtd",achieved:false,trata:this};a.qtd=b;return a};Objective.VarQtd.prototype.checkObjective=function(a,b){return(Game.jsInterpreter.variables.length-1)<=b.qtd};Objective.VarQtd.prototype.createExplanationItem=function(a){var b=BlocklyApps.getMsg("explanation_varQtd");return b.format(a.qtd)};Objective.CommsQtd=function(){};Objective.CommsQtd.prototype.init=function(b){var a={objective:"commQtd",achieved:false,trata:this};a.qtd=b;return a};Objective.CommsQtd.prototype.checkObjective=function(a,b){var c=Game.countInstructions(Blockly.mainWorkspace.getTopBlocks());return c<=b.qtd};Objective.CommsQtd.prototype.createExplanationItem=function(a){var b=BlocklyApps.getMsg("explanation_commsQtd");return b.format(a.qtd)};var digitsImage=new Image();digitsImage.src="images/numbers.png";function showMoney(e,b){var c=e+"";while(c.length<3){c="0"+c}for(var d=0;d<3;d++){var a=parseInt(c[d])*16;b.drawImage(digitsImage,a,0,16,16,298+(d*13),8,16,16)}}function generateImages(a,b){a=a+"";while(a.length<b){a="0"+a}var c=new Array(b);$.each(c,function(d){c[d]=a[d]+".png"});return c};var Questionnaire={};Questionnaire.createForm=function(g){var b=document.createElement("form");var a=document.createElement("div");a.style.width="600px";a.style.height="480px";a.style.overflow="scroll";a.id="questions";var p=document.createElement("table");a.appendChild(p);b.appendChild(a);var m=document.createElement("input");var n=1;for(var d=0;d<g.length;d++){for(var e=0;e<g[d].questions.length;e++){var h=document.createElement("tr");h.setAttribute("questionId",g[d].questions[e].id);var c=document.createElement("td");h.appendChild(c);c.innerHTML="<b>"+(n++)+"</b> - "+g[d].questions[e].description;c=document.createElement("td");h.appendChild(c);p.appendChild(h);h=document.createElement("tr");h.setAttribute("questionId",g[d].questions[e].id);c=document.createElement("td");switch(g[d].questions[e].type[0].toUpperCase()){case"N":m=document.createElement("input");m.setAttribute("questionId",g[d].questions[e].id);m.className="answer";m.name=g[d].id+"_"+g[d].questions[e].id;m.type="number";m.min="0";m.max="130";m.setAttribute("questionrequired",new String(g[d].questions[e].required).toUpperCase());m.onkeypress=function(i){return((i.charCode>=48&&i.charCode<=57)||i.charCode==0)};m.addEventListener("change",Questionnaire.closeDrop,false);c.appendChild(m);break;case"S":var f="a";for(var l=0;l<g[d].questions[e].options.length;l++){m=document.createElement("input");m.setAttribute("questionId",g[d].questions[e].id);m.className="answer";m.name=g[d].id+"_"+g[d].questions[e].id;m.type="radio";m.value=g[d].questions[e].options[l].value;m.id=g[d].id+"_"+g[d].questions[e].id+"_"+l;m.setAttribute("questionrequired",new String(g[d].questions[e].required).toUpperCase());m.addEventListener("change",Questionnaire.closeDrop,false);var k=document.createElement("label");k.innerHTML=f+") ";f=Questionnaire.nextChar(f);c.appendChild(k);c.appendChild(m);k=document.createElement("label");k.htmlFor=m.id;k.innerHTML=g[d].questions[e].options[l].description;c.appendChild(k);var o=document.createElement("br");c.appendChild(o)}break;case"T":if(g[d].questions[e].type.length==1){m.type="text";m.setAttribute("questionId",g[d].questions[e].id);m.name=g[d].questions[e].id;m.style.width="100px";m.setAttribute("questionrequired",new String(g[d].questions[e].required).toUpperCase());m.addEventListener("change",Questionnaire.closeDrop,false);c.appendChild(m)}else{var q=g[d].questions[e].type.substring(1,g[d].questions[e].type.length);var f="a";for(var l=0;l<q;l++){m=document.createElement("input");m.setAttribute("questionId",g[d].questions[e].id);m.className="answer";m.name=g[d].id+"_"+g[d].questions[e].id;m.type="text";m.style.width="300px";m.style.marginTop="5px";m.setAttribute("questionrequired",new String(g[d].questions[e].required).toUpperCase());m.addEventListener("change",Questionnaire.closeDrop,false);var k=document.createElement("label");k.innerHTML=f+") ";f=Questionnaire.nextChar(f);c.appendChild(k);c.appendChild(m);var o=document.createElement("br");c.appendChild(o)}}break}h.appendChild(c);p.appendChild(h)}}return b};Questionnaire.closeDrop=function(){if(Questionnaire.drop!=null&&Questionnaire.drop!=undefined){Questionnaire.drop.close();Questionnaire.drop=null}};Questionnaire.nextChar=function(a){return String.fromCharCode(a.charCodeAt(0)+1)};Questionnaire.handlingQuestionnaire=function(){var d=document.getElementsByClassName("answer");var g=[];for(var c=0;c<d.length;c++){var j=d[c];var h=j.name.split("_")[0];var a=j.name.split("_")[1];switch(j.type.toUpperCase()){case"RADIO":var f=document.getElementsByName(j.name);for(var e=0;e<f.length;e++){if(f[e].checked){var h=j.name.split("_")[0];var a=j.name.split("_")[1];g.push([h,a,f[e].value])}if(e!=f.length-1){c++}}break;case"NUMBER":g.push([h,a,j.value]);break;case"TEXT":var f=document.getElementsByName(j.name);var b="";for(var e=0;e<f.length;e++){if(f[e].value!=""){b=b+"<answer><![CDATA["+f[e].value+"]]></answer>"}if(e!=f.length-1){c++}}if(b.length>0){g.push([h,a,b])}break}}UserControl.saveQuestionnaire(g)};Questionnaire.consistQuestionnaire=function(){var c=false;var d=document.getElementsByClassName("answer");for(var b=0;b<d.length;b++){var m=d[b];var l=m.name.split("_")[0];var a=m.name.split("_")[1];var k=false;switch(m.type.toUpperCase()){case"RADIO":var j=document.getElementsByName(m.name);if(j[0].getAttribute("questionrequired").toUpperCase()=="TRUE"){for(var g=0;g<j.length;g++){if(j[g].checked){k=true}if(g!=j.length-1){b++}}}else{k=true}break;case"NUMBER":if(m.getAttribute("questionrequired").toUpperCase()=="TRUE"){if(m.value!=""){k=true}}else{k=true}break;case"TEXT":var j=document.getElementsByName(m.name);if(j[0].getAttribute("questionrequired").toUpperCase()=="TRUE"){for(var g=0;g<j.length;g++){if(j[g].value==""){break}if(g!=j.length-1){b++}k=true}}else{k=true}break}if(!k){c=true;var e=Questionnaire.getTrsByQuestionId(a);for(var g=0;g<e.length;g++){e[g].style.color="red"}var f=Questionnaire.getInputByQuestionId(a);f.focus();if(f.type=="radio"){f=f.labels[0]}Questionnaire.drop=new Drop({target:f,content:BlocklyApps.getMsg("NoBugs_requiredField"),position:"right middle",classes:"drop-theme-arrows",openOn:null});Questionnaire.drop.open();return}else{var h=Questionnaire.getTrsByQuestionId(a);for(var g=0;g<h.length;g++){h[g].style.color="black"}}}return !c};Questionnaire.getTrsByQuestionId=function(a){var d=[];var c=document.getElementsByTagName("tr");for(var b=0;b<c.length;b++){if(c[b].getAttribute("questionId")==a){d.push(c[b])}}return d};Questionnaire.getInputByQuestionId=function(a){var c=document.getElementsByClassName("answer");for(var b=0;b<c.length;b++){if(c[b].getAttribute("questionId")==a){return c[b]}}return null};var VariableNames={};var regex=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|null|this|true|void|with|break|catch|class|const|false|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[\x24A-Z\x5Fa-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F0\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC][\x240-9A-Z\x5Fa-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0\u08A2-\u08AC\u08E4-\u08FE\u0900-\u0963\u0966-\u096F\u0971-\u0977\u0979-\u097F\u0981-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C01-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58\u0C59\u0C60-\u0C63\u0C66-\u0C6F\u0C82\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D02\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D60-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F0\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191C\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1D00-\u1DE6\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA697\uA69F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7B\uAA80-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE26\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]*$/;VariableNames.validate=function(a){return regex.test(a)};