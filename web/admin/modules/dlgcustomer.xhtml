<ui:composition xmlns="http://www.w3c.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">
	
	<p:dialog id="customerDialog" 
	widgetVar="customerDlg" modal="true" showEffect="clip"
	hideEffect="fade" header="#{msg['customer']}"
	minWidth="900" width="900" minHeight="500" height="515"
	closable="false"
	onShow="PF('customerDlg').initPosition()">
		<h:form id="customerForm" style="height:100%;">
			<p:layout style="min-width:850px;width:100%;min-height:490px;height:100%;">
				<p:layoutUnit position="north">	
					<p:panelGrid columns="4">
						<h:outputText value="#{msg['skin']}:"/>
		        		<p:selectOneMenu style="width:100px" value="#{custVC.customer.skin}" 
							effect="fade" converter="#{custVC.sc}" var="s">
							<f:selectItems value="#{custVC.customerSkins}" var="skin" itemLabel="#{skin.displayName}" itemValue="#{skin}"/>
							<p:column>
								<p:graphicImage value="#{s.image}" width="32" height="32"/>
							</p:column>
							
							<p:column>
								#{s.displayName}
							</p:column>
		        		</p:selectOneMenu>
		        		
		        		<h:outputText value="#{msg['rndmType']}:"/>
		        		<p:selectOneRadio value="#{custVC.customer.randomType}">
				            <f:selectItem itemLabel="#{msg['none']}" itemValue="none"  />
				            <f:selectItem itemLabel="#{msg['atLeastOne']}" itemValue="atLeastOne" />
		        		</p:selectOneRadio>
		        		
		        		<h:outputText value="#{msg['startsFrom']}:"/>
						<p:selectOneMenu value="#{custVC.customer.init}">
							<f:selectItems value="#{custVC.initPositions}" />
		        		</p:selectOneMenu>
		        		
		        		<h:outputText value="#{msg['goesTo']}:"/>
						<p:selectOneMenu value="#{custVC.customer.dest}">
							<f:selectItems value="#{custVC.destPositions}" />
		        		</p:selectOneMenu>
					</p:panelGrid>
					
				</p:layoutUnit>
				
				<p:layoutUnit position="west" size="150">
					<f:facet name="header">
		        		<div class="clear">
	        				<h:outputText value="#{msg['orders']}" />
	        				<p:commandButton style="float: right;" icon="ui-icon-circle-plus" 
	        					actionListener="#{custVC.newOrder}"
	        					update=":customerForm, :growlMsgs"/>
	        			</div>
	    			</f:facet>
					
					<p:dataTable id="ordersDT" styleClass="hide-column-names" selectionMode="single"
						selection="#{custVC.customer.orders.order}"
						var="order" rowKey="#{order.id}" emptyMessage="#{msg['default']}"
						value="#{custVC.customer.orders.orders}"
						draggableRows="true">
						<p:ajax event="rowReorder" update=":customerForm"/>

						<p:ajax event="rowSelect" update=":customerForm"/>
		    			<p:column style="width:74%;">
		    				<h:outputText value="#{msg['no']}: #{order.id}" />
		    			</p:column>
		    			<p:column style="padding:2px;">
		    				<p:commandButton icon="ui-icon-closethick"
								oncomplete="PF('confDeleteOrderDlg').show()">
								<f:setPropertyActionListener value="#{order}" target="#{custVC.customer.orders.order}"/>
							</p:commandButton>
		    			</p:column>
    				</p:dataTable>
				</p:layoutUnit>
				
				<p:layoutUnit position="center">
					<p:panelGrid columns="1">
						<div id="foodsContainer">
							<p:panelGrid columns="6">
								<h:outputText value="#{msg['rndmMin']}:"/>
								<p:inputText value="#{custVC.customer.orders.order.randomMinFoods}" style="width:100px;"/>
								
								<h:outputText value="#{msg['rndmMax']}:"/>
								<p:inputText value="#{custVC.customer.orders.order.randomMaxFoods}" style="width:100px;"/>
								
								<p:selectBooleanCheckbox value="#{custVC.customer.orders.order.differentFromPrevFoods}"/>
								<h:outputText value="#{msg['diffFromPrev']}"/>
							</p:panelGrid>
							
							<p:dataTable id="foodsDT" var="food"
								value="#{custVC.customer.orders.order.foods}" draggableRows="true">
								<p:ajax event="rowReorder" update=":customerForm:foodsDT"/>

								<f:facet name="header">
							        <h:outputText value="#{msg['foods']}"/>
							    </f:facet>
							    <f:facet name="footer">
							    	<div class="clear">
							    		<p:commandButton style="float: right;" value="#{msg['add']}" icon="ui-icon-circle-plus"
							    			actionListener="#{custVC.setFoodstuffType(true)}"
							    			oncomplete="PF('addFoodstuffDlg').show()"/>
							    	</div>
					        	</f:facet>
							    
							    <p:column headerText="#{msg['type']}">
							        <h:outputText value="#{food.name}"/>
							    </p:column>
							 
							    <p:column headerText="#{msg['qtd']}">
							        <h:outputText value="#{food.qtd}"/>
							    </p:column>
							 
							    <p:column headerText="#{msg['price']}">
							        <h:outputText value="#{food.price}"/>
							    </p:column>
							 
							    <p:column headerText="#{msg['actions']}" width="70">
							        <p:commandButton icon="ui-icon-pencil"
							        	update=":foodstuffForm"
							    		oncomplete="PF('addFoodstuffDlg').show()">
							    		<f:setPropertyActionListener value="#{food}" target="#{custVC.food}"/>
							        </p:commandButton>
							        
							        <p:commandButton icon="ui-icon-closethick"
							        	oncomplete="PF('confDeleteFoodDlg').show()">
							        	<f:setPropertyActionListener value="#{food}" target="#{custVC.food}"/>
							        </p:commandButton>    	        
							    </p:column>
							</p:dataTable>
						</div>
						
						<div id="drinksContainer">
							<p:panelGrid columns="6">
								<h:outputText value="#{msg['rndmMin']}:"/>
								<p:inputText value="#{custVC.customer.orders.order.randomMinDrinks}" style="width:100px;"/>
								
								<h:outputText value="#{msg['rndmMax']}:"/>
								<p:inputText value="#{custVC.customer.orders.order.randomMaxDrinks}" style="width:100px;"/>
								
								<p:selectBooleanCheckbox value="#{custVC.customer.orders.order.differentFromPrevDrinks}"/>
								<h:outputText value="#{msg['diffFromPrev']}"/>
							</p:panelGrid>
							
							<p:dataTable id="drinksDT" var="drink" 

								value="#{custVC.customer.orders.order.drinks}" draggableRows="true">
								<p:ajax event="rowReorder" update=":customerForm:drinksDT"/>

								<f:facet name="header">
							        <h:outputText value="#{msg['drinks']}"/>
							    </f:facet>
							    <f:facet name="footer">
							    	<div class="clear">
							    		<p:commandButton style="float: right;" value="#{msg['add']}" icon="ui-icon-circle-plus"
							    			actionListener="#{custVC.setFoodstuffType(false)}"
							    			oncomplete="PF('addBeverageDlg').show()"/>
							    	</div>
					        	</f:facet>
					        	    
							    <p:column headerText="#{msg['type']}">
							        <h:outputText value="#{drink.name}"/>
							    </p:column>
							 
							    <p:column headerText="#{msg['qtd']}">
							        <h:outputText value="#{drink.qtd}"/>
							    </p:column>
							 
							    <p:column headerText="#{msg['price']}">
							        <h:outputText value="#{drink.price}"/>
							    </p:column>
							 
							    <p:column headerText="#{msg['actions']}" width="70">
							        <p:commandButton icon="ui-icon-pencil"
							        	update=":beverageForm"
							    		oncomplete="PF('addBeverageDlg').show()">
							    		<f:setPropertyActionListener value="#{drink}" target="#{custVC.drink}"/>
							        </p:commandButton>
							        	
							        <p:commandButton icon="ui-icon-closethick"
							        	oncomplete="PF('confDeleteDrinkDlg').show()">
							        	<f:setPropertyActionListener value="#{drink}" target="#{custVC.drink}"/>
							        </p:commandButton>
							    </p:column>		    
							</p:dataTable>
						</div>
					</p:panelGrid>
				</p:layoutUnit>
				
				<p:layoutUnit position="south">
					<p:panelGrid columns="2" style="float: right;">
			    		<p:commandButton value="#{msg['ok']}" icon="ui-icon-check" 
			    			actionListener="#{custVC.saveCustomer}"
			    			update=":customerForm, :tbView:customersForm, :growlMsgs"/>
			       	</p:panelGrid>
				</p:layoutUnit>
			</p:layout>
		</h:form>
	</p:dialog>
	
	<ui:include src="dlgaddfoodstuff.xhtml"/>
	<ui:include src="dlgaddbeverage.xhtml"/>
	
	<p:dialog widgetVar="confDeleteFoodDlg" header="#{msg['confirmation']}" 
		closable="false" modal="true" 
		resizable="false" dynamic="true"
		onShow="PF('confDeleteFoodDlg').initPosition()">

		<h:form>
			<p:panelGrid columns="3" style="margin: 0 auto; width: 100%;">
				<h:outputText value="#{msg['ruSureDelFood']}" />
				<p:commandButton value="#{msg['yes']}"
					styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
					update=":customerForm" actionListener="#{custVC.deleteFood}"
					oncomplete="PF('confDeleteFoodDlg').hide()" />
				<p:commandButton value="#{msg['no']}"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close"
					actionListener="#{custVC.resetFood}"
					oncomplete="PF('confDeleteFoodDlg').hide()" />
			</p:panelGrid>
		</h:form>
	</p:dialog>
	
	<p:dialog widgetVar="confDeleteDrinkDlg" header="#{msg['confirmation']}" 
		closable="false" modal="true" 
		resizable="false" dynamic="true"
		onShow="PF('confDeleteDrinkDlg').initPosition()">

		<h:form>
			<p:panelGrid columns="3" style="margin: 0 auto; width: 100%;">
				<h:outputText value="#{msg['ruSureDelDrink']}" />
				<p:commandButton value="#{msg['yes']}"
					styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
					update=":customerForm" actionListener="#{custVC.deleteDrink}"
					oncomplete="PF('confDeleteDrinkDlg').hide()" />
				<p:commandButton value="#{msg['no']}"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close"
					actionListener="#{custVC.resetDrink}"
					oncomplete="PF('confDeleteDrinkDlg').hide()" />
			</p:panelGrid>
		</h:form>
	</p:dialog>
	
	<p:dialog widgetVar="confDeleteOrderDlg" header="#{msg['confirmation']}" 
		closable="false" modal="true" 
		resizable="false" dynamic="true"
		onShow="PF('confDeleteOrderDlg').initPosition()">

		<h:form>
			<p:panelGrid columns="3" style="margin: 0 auto; width: 100%;">
				<h:outputText value="#{msg['ruSureDelOrder']}" />
				<p:commandButton value="#{msg['yes']}"
					styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
					update=":customerForm,:growlMsgs" actionListener="#{custVC.deleteOrder}"
					oncomplete="PF('confDeleteOrderDlg').hide()" />
				<p:commandButton value="#{msg['no']}"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close"
					oncomplete="PF('confDeleteOrderDlg').hide()" />
			</p:panelGrid>
		</h:form>
	</p:dialog>
	
</ui:composition>