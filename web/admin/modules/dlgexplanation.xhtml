<ui:composition xmlns="http://www.w3c.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions"
	>
	
		<h:outputScript>
		
			function resizeCkEditorExpl() {
				if (PF('ckEditorExplPage').instance != null)
					PF('ckEditorExplPage').instance.resize('100%', document.getElementById('formExplPage:centerExplPage').clientHeight-10);
			}; 
			
			function handleRequest(xhr, status, args) {
        		if(!args.validationFailed) {
        			PF('ckEditorExplPage').destroy();
        			explPageUpdateComponents();
        		}
        }


		</h:outputScript>
		
	
		<p:dialog id="explPageDlg" showEffect="fade" hideEffect="fade"
			widgetVar="pageDialog" header="#{msg['pages']}" minHeight="545"
			minWidth="700" width="700" closable="false" style="overflow: hidden !important;"
			modal="true" onShow="PF('pageDialog').initPosition(); resizeCkEditorExpl();" dynamic="true"
			>
			<h:form style="height:100%;" id="formExplPage">
				<p:growl id="specificGrowl" showDetail="true" autoUpdate="true"/>
				<p:remoteCommand name="explPageUpdateComponents" update=":tbView:explForm:opList, explPageDlg" />
			
				<p:layout style="width:100%;min-height:400px;height:100%;" onResize="if (e.edge) { resizeCkEditorExpl();}">
					<p:layoutUnit id="centerExplPage" position="center" styleClass="disable-scroll" style="border: none;" resizable="true" >
						<pe:ckEditor id="editExplPage" widgetVar="ckEditorExplPage"
									width="100%" value="#{explVC.page.msg}" toolbar="#{explVC.editorControls}"
									customConfig="#{request.contextPath}/admin/modules/config.js">
									
							<pe:javascript event="initialize" execute="resizeCkEditorExpl();"/>
						</pe:ckEditor>
					</p:layoutUnit>
					<p:layoutUnit position="south" style="border: none;" size="50">
						<p:panelGrid columns="2" style="float: right;">
						
							<p:commandButton value="#{msg['ok']}" icon="ui-icon-check"
								actionListener="#{explVC.addPage}"
								oncomplete="handleRequest(xhr, status, args)"
								/>
								
							<p:commandButton value="#{msg['cancel']}" icon="ui-icon-close"
								update="explPageDlg"
								actionListener="#{explVC.resetPage}"
								onsuccess = "PF('ckEditorExplPage').destroy();"/>
								
						</p:panelGrid>
					</p:layoutUnit>
				</p:layout>
			</h:form>
		</p:dialog>

	<p:dialog widgetVar="confDeleteDlg" header="#{msg['confirmation']}" 
		closable="false" modal="true" 
		resizable="false" dynamic="true">

		<h:form>
			<p:panelGrid columns="3" style="margin: 0 auto; width: 100%;">
				<h:outputText value="#{msg['ruSureDelPage']}" />
				<p:commandButton value="#{msg['yes']}"
					styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
					update=":tbView:explForm" actionListener="#{explVC.deleteExplPage}"
					oncomplete="PF('confDeleteDlg').hide()" />
				<p:commandButton value="#{msg['no']}"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close"
					actionListener="#{explVC.resetPage}"
					oncomplete="PF('confDeleteDlg').hide()" />
			</p:panelGrid>
		</h:form>
	</p:dialog>
</ui:composition>